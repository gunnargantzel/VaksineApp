# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
App:
  Properties:
    BackEnabled: =false
    Formulas: |+
      =//FregNavn = IfError(fnFiksFolkeregisteret.HentSisteVersjonAvPerson(rSok),Blank());
      //FregNavn = First(FiksFolkeregisteret.HentSisteVersjonAvPerson("03016828911").navn);
      //Navn = TrimEnds(FregNavn.etternavn  & " " & FregNavn.fornavn & " " & FregNavn.mellomnavn);
    OnStart: "=Set(\r\n    AppTheme,\r\n    {\r\n        palette: {\r\n            themePrimary: \"#2A2859\",\r\n            themeLighterAlt: \"#eff6fc\",\r\n            themeLighter: \"#deecf9\",\r\n            themeLight: \"#c7e0f4\",\r\n            themeTertiary: \"#71afe5\",\r\n            themeSecondary: \"#2b88d8\",\r\n            themeDarkAlt: \"#106ebe\",\r\n            themeDark: \"#005a9e\",\r\n            themeDarker: \"#004578\",\r\n            neutralLighterAlt: \"#faf9f8\",\r\n            neutralLighter: \"#f3f2f1\",\r\n            neutralLight: \"#edebe9\",\r\n            neutralQuaternaryAlt: \"#e1dfdd\",\r\n            neutralQuaternary: \"#d0d0d0\",\r\n            neutralTertiaryAlt: \"#c8c6c4\",\r\n            neutralTertiary: \"#a19f9d\",\r\n            neutralSecondary: \"#605e5c\",\r\n            neutralPrimaryAlt: \"#3b3a39\",\r\n            neutralPrimary: \"#323130\",\r\n            neutralDark: \"#201f1e\",\r\n            black: \"#000000\",\r\n            white: \"#ffffff\"\r\n        }\r\n    }\r\n);\r\n\r\nSet(\r\n    AppTheme,\r\n   { palette: { themePrimary: \"#034B45\", themeLighterAlt: \"#cee9e7\", themeLighter: \"#a6d5d1\", themeLight: \"#82c1bc\", themeTertiary: \"#63aea7\", themeSecondary: \"#479a93\", themeDarkAlt: \"#30867f\", themeDark: \"#1d726b\", themeDarker: \"#0e5e57\", neutralLighterAlt: \"#faf9f8\", neutralLighter: \"#f3f2f1\", neutralLight: \"#edebe9\", neutralQuaternaryAlt: \"#e1dfdd\", neutralQuaternary: \"#d0d0d0\", neutralTertiaryAlt: \"#c8c6c4\", neutralTertiary: \"#a19f9d\", neutralSecondary: \"#605e5c\", neutralPrimaryAlt: \"#3b3a39\", neutralPrimary: \"#323130\", neutralDark: \"#201f1e\", black: \"#000000\", white: \"#ffffff\"}}\r\n    \r\n);\r\n\r\nSet(\r\n    AppThemeJson,\r\n    JSON(\r\n        AppTheme,\r\n        JSONFormat.IndentFour\r\n    )\r\n);\r\n\r\nSet( AdminAdGruppe, LookUp('Environment Variable Definitions',  'Schema Name' = \"sogv_AdminAdGruppe\" ,'Default Value'));\r\nSet( AnsattVaksineAdGruppe, LookUp('Environment Variable Definitions',  'Schema Name' = \"sogv_AnsattVaksineAdGruppe\" ,'Default Value'));\r\nSet( InnbyggerVaksineAdGruppe, LookUp('Environment Variable Definitions',  'Schema Name' = \"sogv_InnbyggerVaksineAdGruppe\" ,'Default Value'));\r\n\r\nSet(Innbyggervaksinering, false);Set(Ansattvaksinering, false);Set(Admin, false);\r\n\r\nSet(Innbyggervaksinering,IfError(!IsEmpty(Graph.checkMemberGroups(User().EntraObjectId,{'$filter':\"id eq '\" & InnbyggerVaksineAdGruppe & \"'\",'$select':\"displayName\"} ).value),false));\r\nSet(Ansattvaksinering,IfError(!IsEmpty(Graph.checkMemberGroups(User().EntraObjectId,{'$filter':\"id eq '\" & AnsattVaksineAdGruppe & \"'\"}).value),false));\r\nSet(Admin,IfError(!IsEmpty(Graph.checkMemberGroups(User().EntraObjectId,{'$filter':\"id eq '\" & AdminAdGruppe & \"'\",'$select':\"displayName\"}).value),false));\r\n\r\nSet(VaskineringToggle, If(Admin Or (Innbyggervaksinering And Ansattvaksinering), true, false));\r\nSet(Lonnsperiode, LookUp(SortByColumns('Ansattoversikt basert på lonn',\"sogv_lonnsperiode\"),1=1,Lønnsperiode));\r\n"
    Theme: =SteelTheme
