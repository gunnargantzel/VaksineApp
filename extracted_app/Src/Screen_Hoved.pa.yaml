# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Screen_Hoved:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: |-
        =UpdateContext(
            {
                PersonSoekResponse: Blank(),
                Klokka: Now()
            }
        )
    Children:
      - Body:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Height: =Parent.Height
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            Width: =Parent.Width
          Children:
            - HeaderTitleContainer:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  FillPortions: =0
                  Height: =50
                  LayoutDirection: =LayoutDirection.Horizontal
                Children:
                  - Header_2:
                      Control: CanvasComponent
                      ComponentName: Header
                      ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
                      Properties:
                        BackButtonVisible: =true
                        Color: =
                        ContentWidth: =App.Width
                        Fill: =Color.Transparent
                        FillPortions: =1
                        HeaderFill: =If(manuellRegistrering,RGBA(255, 0, 0, 1))
                        Height: =50
                        LeftButtonImage: |-
                          ="data:image/svg+xml;utf8, " & EncodeUrl("<svg
                             version='1.1'
                             id='Layer_1'
                             x='0px'
                             y='0px'
                             viewBox='0 0 35.000001 27.086091'
                             xml:space='preserve'
                             width='35'
                             height='27.086092'
                             xmlns='http://www.w3.org/2000/svg'
                             xmlns:svg='http://www.w3.org/2000/svg'><defs
                             id='defs65' />
                          <style
                             type='text/css'
                             id='style48'>
                          	.st0{fill:#FAFBFB;}
                          </style>
                          <g
                             id='Layer_2_1_'
                             transform='matrix(0.66225166,0,0,0.66225166,0.04966887,0)'>
                          	<g
                             id='Layer_1-2'>
                          		<path
                             class='st0'
                             d='m 38.1,20.5 c 0,-0.6 0.2,-1.2 0.7,-1.7 l 5,-5 c 0.9,-0.9 2.4,-0.9 3.3,0 0,0 0,0 0,0 l 5,5 c 0.9,0.9 0.9,2.4 0,3.3 l -5,5 c -0.9,0.9 -2.4,0.9 -3.3,0 0,0 0,0 0,0 l -5,-5 c -0.4,-0.3 -0.7,-0.9 -0.7,-1.6 z'
                             id='path50' />
                          		<path
                             class='st0'
                             d='m 11,7.4 c 0,-0.6 0.2,-1.2 0.7,-1.7 l 5,-5 c 0.9,-0.9 2.4,-0.9 3.3,0 0,0 0,0 0,0 l 5,5 c 0.5,0.4 0.7,1 0.7,1.7 C 25.7,8 25.4,8.6 25,9 l -5,5 c -0.9,0.9 -2.4,0.9 -3.3,0 0,0 0,0 0,0 l -5,-5 C 11.2,8.6 11,8 11,7.4 Z'
                             id='path52' />
                          		<path
                             class='st0'
                             d='m 27.2,7.4 c 0,-0.6 0.2,-1.2 0.7,-1.7 l 5,-5 C 33.4,0.2 34,0 34.6,0 c 0.6,0 1.2,0.2 1.6,0.7 l 5,5 c 0.5,0.4 0.7,1 0.7,1.7 0,0.6 -0.3,1.2 -0.7,1.6 l -5,5 c -0.4,0.4 -1,0.7 -1.6,0.7 -0.6,0 -1.2,-0.2 -1.7,-0.7 l -5,-5 C 27.5,8.6 27.2,8 27.2,7.4 Z'
                             id='path54' />
                          		<path
                             class='st0'
                             d='M 42.7,32.3 29,18.5 C 28.8,18.3 28.5,18 28.3,17.8 28.1,17.5 27.8,17.3 27.5,17 27.2,16.8 27,16.6 26.7,16.4 c -0.3,-0.2 -0.7,-0.2 -1,-0.2 -0.3,0 -0.7,0.1 -1,0.2 -0.3,0.2 -0.6,0.4 -0.9,0.6 -0.3,0.2 -0.5,0.5 -0.8,0.8 -0.3,0.3 -0.5,0.5 -0.7,0.7 L 8.7,32.3 C 8.2,32.7 8,33.4 8,34 c 0,0.6 0.2,1.2 0.7,1.6 l 5.3,5.3 c 0.2,-0.2 0.3,-0.4 0.5,-0.6 L 23,31.9 c 0.7,-0.8 1.8,-1.2 2.8,-1.2 1,0 2,0.4 2.7,1.1 l 2.2,2.2 6.3,6.3 c 0.2,0.2 0.4,0.4 0.5,0.6 l 5.3,-5.3 c 0.4,-0.4 0.7,-1 0.6,-1.6 0.1,-0.6 -0.2,-1.3 -0.7,-1.7 z'
                             id='path56' />
                          		<path
                             class='st0'
                             d='m 7.3,12.1 c 0.6,0 1.2,0.2 1.6,0.7 l 5,5 c 0.9,0.9 0.9,2.4 0,3.4 l -5,5 c -0.4,0.4 -1,0.7 -1.6,0.7 -0.6,0 -1.2,-0.2 -1.7,-0.7 l -5,-5 c -0.9,-0.9 -0.9,-2.4 0,-3.4 l 5,-5 c 0.5,-0.5 1.1,-0.7 1.7,-0.7 z'
                             id='path58' />
                          	</g>
                          </g>
                          </svg>")
                        LeftButtonVisible: =true
                        OnBackSelect: |-
                          =Navigate(Hovedmeny,ScreenTransition.Fade);
                          Set(NySesjon, false);
                          UpdateContext(
                              {
                                  PersonSoekResponse: Blank()
                              }
                          )
                        OnLeftButtonSelect: =true
                        OnRightButtonSelect: =Refresh(Vaksinerings)
                        RightButtonImage: |-
                          ="data:image/svg+xml," & 
                           EncodeUrl(
                              "<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 64 64' width='64px' height='64px'>
                          <g id='surface29844360'>
                          <path style=' stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;' d='M 32 8 C 21.773438 8 13.234375 14.320312 9.75 23.25 L 13.4375 24.75 C 16.351562 17.28125 23.421875 12 32 12 C 38.484375 12 44.265625 15.179688 47.875 20 L 40 20 L 40 24 L 54 24 L 54 10 L 50 10 L 50 16.1875 C 45.617188 11.164062 39.140625 8 32 8 Z M 50.5625 39.25 C 47.648438 46.71875 40.578125 52 32 52 C 25.445312 52 19.6875 48.773438 16.0625 44 L 24 44 L 24 40 L 10 40 L 10 54 L 14 54 L 14 47.8125 C 18.375 52.773438 24.789062 56 32 56 C 42.226562 56 50.765625 49.679688 54.25 40.75 Z M 50.5625 39.25 '/>
                          </g></svg>"
                          )
                        RightButtonVisible: =true
                        Text: |-
                          =TabListAccount.Selected.'Account Name' & " Ledige timer: (" & If(
                              CheckKunIdag.Checked = true,
                              CountRows(
                                  Filter(
                                      Vaksinerings,
                                      Timeavtale >= If(
                                          CheckboxCanvas1.Checked,
                                          DateAdd(
                                              DropdownDato.SelectedDate,
                                              12,
                                              TimeUnit.Hours
                                          ),
                                          DropdownDato.SelectedDate
                                      ) And Timeavtale <= DateAdd(
                                          DropdownDato.SelectedDate,
                                          1
                                      ) And ThisRecord.'Hovedtype vaksine' = ComboboxKategori.Selected.Value And ThisRecord.Timeboktype in ComboboxCanvasTimebok.SelectedItems 
                                      // ThisRecord.Timeboktype = DropdownTimebok.Selected.Value 
                          And ThisRecord.Account.Account = GUID(TabListAccount.Selected.Account) And ThisRecord.'Status for timeavtale' in ComboboxStatus.SelectedItems And (SearchBox1.SearchText in Name Or SearchBox1.SearchText in Fnr) And IsBlank(Fnr) And ThisRecord.Status = 0
                                  )
                              ),
                              CountRows(
                                  Filter(
                                      Vaksinerings,
                                      Timeavtale >= If(
                                          CheckboxCanvas1.Checked,
                                          DateAdd(
                                              DropdownDato.SelectedDate,
                                              12,
                                              TimeUnit.Hours
                                          ),
                                          DropdownDato.SelectedDate
                                      ) And ThisRecord.'Hovedtype vaksine' = ComboboxKategori.Selected.Value And ThisRecord.Timeboktype in ComboboxCanvasTimebok.SelectedItems 
                                      //ThisRecord.Timeboktype = DropdownTimebok.Selected.Value 
                          And ThisRecord.Account.Account = GUID(TabListAccount.Selected.Account) And ThisRecord.'Status for timeavtale' in ComboboxStatus.SelectedItems And (SearchBox1.SearchText in Name Or SearchBox1.SearchText in Fnr) And IsBlank(Fnr) And ThisRecord.Status = 0
                                  )
                              )
                          ) & ") Opptatte timer: (" & If(
                              CheckKunIdag.Checked = true,
                              CountRows(
                                  Filter(
                                      Vaksinerings,
                                      Timeavtale >= If(
                                          CheckboxCanvas1.Checked,
                                          DateAdd(
                                              DropdownDato.SelectedDate,
                                              12,
                                              TimeUnit.Hours
                                          ),
                                          DropdownDato.SelectedDate
                                      ) And Not(IsBlank(Fnr)) And Timeavtale <= DateAdd(
                                          DropdownDato.SelectedDate,
                                          1
                                      ) And ThisRecord.'Hovedtype vaksine' = ComboboxKategori.Selected.Value And ThisRecord.Timeboktype in ComboboxCanvasTimebok.SelectedItems 
                                      //ThisRecord.Timeboktype = DropdownTimebok.Selected.Value 
                          And ThisRecord.Account.Account = GUID(TabListAccount.Selected.Account) And ThisRecord.'Status for timeavtale' in ComboboxStatus.SelectedItems And (SearchBox1.SearchText in Name Or SearchBox1.SearchText in Fnr) And ThisRecord.Status = 0
                                  )
                              ),
                              CountRows(
                                  Filter(
                                      Vaksinerings,
                                      Timeavtale >= If(
                                          CheckboxCanvas1.Checked,
                                          DateAdd(
                                              DropdownDato.SelectedDate,
                                              12,
                                              TimeUnit.Hours
                                          ),
                                          DropdownDato.SelectedDate
                                      ) And Not(IsBlank(Fnr)) And ThisRecord.'Hovedtype vaksine' = ComboboxKategori.Selected.Value And ThisRecord.Timeboktype in ComboboxCanvasTimebok.SelectedItems 
                                      //ThisRecord.Timeboktype = DropdownTimebok.Selected.Value 
                          And ThisRecord.Account.Account = GUID(TabListAccount.Selected.Account) And ThisRecord.'Status for timeavtale' in ComboboxStatus.SelectedItems And (SearchBox1.SearchText in Name Or SearchBox1.SearchText in Fnr) And ThisRecord.Status = 0
                                  )
                              )
                          ) & ")" & If(
                              CheckKunIdag.Checked = true,
                              " (kun " & Text(
                                  If(
                                      CheckboxCanvas1.Checked,
                                      DateAdd(
                                          DropdownDato.SelectedDate,
                                          12,
                                          TimeUnit.Hours
                                      ),
                                      DropdownDato.SelectedDate
                                  ),
                                  "dd.mm.yyyy hh:mm"
                              ) & ")",
                              " (fra " & Text(
                                  If(
                                      CheckboxCanvas1.Checked,
                                      DateAdd(
                                          DropdownDato.SelectedDate,
                                          12,
                                          TimeUnit.Hours
                                      ),
                                      DropdownDato.SelectedDate
                                  ),
                                  "dd.mm.yyyy hh:mm"
                              ) & ")"
                          )
                        Theme: =AppTheme
                        Width: =App.Width
            - MainSectionContainerHoved:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  LayoutDirection: =LayoutDirection.Vertical
                Children:
                  - Container4:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        FillPortions: =0
                        Height: =175
                        LayoutDirection: =LayoutDirection.Vertical
                      Children:
                        - Container6:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              BorderThickness: =2
                              FillPortions: =0
                              Height: =37
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutGap: =10
                            Children:
                              - NavnFnrLabel:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =30
                                    Text: ="Navn eller FNR:"
                              - NavnFnrInput:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Clear: =true
                                    Default: =""
                                    Font: =Font.'Open Sans'
                                    Height: =30
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnChange: |-
                                      =UpdateContext({ PersonSoekResponse: Blank(), SelectedPerson: Blank()})
                                    OnSelect: |-
                                      =UpdateContext({ PersonSoekResponse: Blank(), SelectedPerson: Blank(),HarIkkeFnr:false });
                                    Reset: =NySesjon
                                    Width: =400
                              - FDatoLabel:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Right
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =30
                                    Text: ="Fødselsdato:"
                                    Width: =130
                              - FDataInput:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Clear: =true
                                    Default: =""
                                    Font: =Font.'Open Sans'
                                    Height: =30
                                    HintText: ="DDMMYY"
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnChange: |-
                                      =


                                      /*
                                      Concatenate("19",Mid(TextInput_dato_1.Text, 2, 4)),
                                                              Concatenate("20",Mid(TextInput_dato_1.Text, 2, 4))
                                                          ) & Mid(TextInput_dato_1.Text, 3, 2) & Left(TextInput_dato_1.Text, 2)*/
                                    Reset: =NySesjon
                                    Width: =110
                              - ButtonSøk:
                                  Control: Button@0.0.45
                                  Properties:
                                    DisplayMode: |-
                                      =If(
                                          Len(NavnFnrInput.Text) = 11 And 
                                          IsNumeric(NavnFnrInput.Text),
                                          DisplayMode.Disabled,
                                          DisplayMode.Edit
                                      )
                                    Height: '=35  '
                                    OnSelect: |-
                                      =UpdateContext({HarIkkeFnr:false});
                                      If(
                                          CountRows(Split(NavnFnrInput.Text," "))>1 Or 
                                          (
                                              Len(NavnFnrInput.Text)>4 && 
                                              Not(IsBlank(FDataInput.Text))
                                          ),

                                          UpdateContext({
                                              PersonSoekResponse: Blank()
                                          });//Tømmer den først så forrige data blir borte fra tabellen, dernest hentes nye personer
                                          UpdateContext({
                                              PersonSoekResponse: 
                                                  FiksFolkeregisteret.Personsoek({
                                                      navn: NavnFnrInput.Text,
                                                      foedselsdato: 
                                                          If(
                                                              Len(FDataInput.Text)>0,
                                                              If(
                                                                  Int(Mid(FDataInput.Text, 5, 2)) <= Year(Today())-2000,
                                                                  Concatenate("20",Mid(FDataInput.Text, 5, 2)),
                                                                  Concatenate("19",Mid(FDataInput.Text, 5, 2))
                                                              ) & Mid(FDataInput.Text, 3, 2) & Left(FDataInput.Text, 2)
                                                          ) 
                                                  }).foedselsEllerDNummer,
                                              //Fjerner forrige valgte person fra listen over personer, siden vi nå har hentet nye personer
                                              SelectedPerson: Blank()
                                          }),
                                          Notify("Skriv inn enten fødselsnummer, fullt navn eller etternavn og fødselsdato for å søke")
                                      )

                                      /*
                                      Notify(
                                          Concatenate(
                                              Concatenate("19",Mid(TextInput_dato_1.Text, 5, 2)),
                                              "-",
                                              Mid(TextInput_dato_1.Text, 3, 2),
                                              "-",
                                              Left(TextInput_dato_1.Text, 2)
                                          )
                                      )
                                      */
                                    Text: ="Finn personer"
                                    Width: =120
                              - ButtonCanvas1:
                                  Control: Button@0.0.45
                                  Properties:
                                    Height: =35
                                    OnSelect: |-
                                      =Reset(NavnFnrInput); Reset(FDataInput);
                                      UpdateContext(
                                          {
                                              PersonSoekResponse: Blank(),
                                              SelectedPerson: Blank(),
                                              showikkeFnr: true,
                                              HarIkkeFnr: true
                                          }
                                      );
                                      Reset(TextInputFornavnIkkeFnr);Reset(DatePickerDobIkkeFnr);Reset(TextInputMobilIkkeFnr);Reset(TextInputEpostIkkeFnr);
                                    Text: ="Person uten norsk fødsels- eller D-nummer"
                                    Visible: =If(Innbyggervaksinering,true, false)
                                    Width: =350
                              - ButtonCanvas1_1:
                                  Control: Button@0.0.45
                                  Properties:
                                    Height: =35
                                    OnSelect: |-
                                      =UpdateContext({
                                          showInnbyggerbookingInv: true
                                      })
                                    Text: ="Invitasjon innbyggerbooking"
                                    Visible: =If(Innbyggervaksinering,true, false)
                                    Width: =350
                        - Label9:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(106, 122, 127, 1)
                              Font: =Font.'Open Sans'
                              Height: '=20  '
                              PaddingBottom: =0
                              PaddingLeft: =NavnFnrInput.X
                              PaddingRight: =0
                              PaddingTop: =0
                              Size: =12
                              Text: ="Søk enten med FNR, fullt navn, eller etternavn og fødselsdato"
                              Width: =Parent.Width
                              X: =NavnFnrInput.X
                        - PersonTabell:
                            Control: CodeComponent
                            ComponentName: cat_PowerCAT.FluentDetailsList
                            Properties:
                              AlignInContainer: =AlignInContainer.Stretch
                              FillPortions: =1
                              Height: =50
                              InputEvent: =//"SetSelection" & Text(Rand())
                              Items: |-
                                =If(
                                    Not(HarIkkeFnr),
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                If(
                                                    Len(PersonSoekFnrHolder.Text) = 11 And IsNumeric(PersonSoekFnrHolder.Text),
                                                    Split(
                                                        PersonSoekFnrHolder.Text,
                                                        "!!!@@@???abcABC"
                                                    ),
                                                    PersonSoekResponse
                                                ),
                                                FregDataRaw,
                                                FiksFolkeregisteret.HentSisteVersjonAvPerson(ThisRecord.Value),
                                                KrrDataRaw,
                                                Krr.Person(ThisRecord.Value)
                                            ),
                                            FregData,
                                            If(
                                                Not(IsBlankOrError(ThisRecord.FregDataRaw)),
                                                ThisRecord.FregDataRaw
                                            ),
                                            FregTreff,
                                            If(
                                                IsBlankOrError(ThisRecord.FregDataRaw),
                                                false,
                                                true
                                            ),
                                            KrrData,
                                            If(
                                                Not(IsBlankOrError(ThisRecord.KrrDataRaw)),
                                                ThisRecord.KrrDataRaw
                                            )
                                        ),
                                        Navn,
                                        If(
                                            ThisRecord.FregTreff,
                                            TrimEnds(
                                                First(ThisRecord.FregData.navn).etternavn & 
                                                " " & First(ThisRecord.FregData.navn).fornavn & 
                                                " " & First(ThisRecord.FregData.navn).mellomnavn
                                            ),
                                            "Ingen treff"
                                        ),
                                        Dob,
                                        Text(
                                            DateTimeValue(First(ThisRecord.FregData.foedsel).foedselsdato),
                                            "dd.mm.yyyy"
                                        ),
                                        Mobil,
                                        If(
                                            Not(IsBlankOrError(KrrData.mobilnummer)),
                                            KrrData.mobilnummer
                                        ),
                                        Epost,
                                        If(
                                            Not(IsBlankOrError(KrrData.epost)),
                                            KrrData.epost
                                        ),
                                        Alder,
                                        If(
                                            ThisRecord.FregTreff,
                                            RoundDown(
                                                DateDiff(
                                                    DateTimeValue(First(ThisRecord.FregData.foedsel).foedselsdato),
                                                    Now(),
                                                    TimeUnit.Days
                                                ) / 365.25,
                                                0
                                            )
                                        ),
                                        SysVak,
                                        If(
                                            ThisRecord.FregTreff And Innbyggervaksinering,
                                            "Sjekk SysVak"
                                        ),
                                        RecordKey,
                                        ThisRecord.Value,
                                        RecordCanSelect,
                                        If(
                                            ThisRecord.FregTreff,
                                            true,
                                            false
                                        )
                                    ),
                                    AddColumns(
                                        PersonSoekResponse,
                                        FregData,
                                        "",
                                        Navn,
                                        TrimEnds(Upper(TextInputEtterNavnIkkeFnr.Text)) & " " & TrimEnds(Upper(TextInputFornavnIkkeFnr.Text)),
                                        Dob,
                                        Text(
                                            DateTimeValue(DatePickerDobIkkeFnr.SelectedDate),
                                            "dd.mm.yyyy"
                                        ),
                                        Mobil,
                                        TextInputMobilIkkeFnr.Text,
                                        Epost,
                                        TextInputEpostIkkeFnr.Text,
                                        Alder,
                                        RoundDown(
                                            DateDiff(
                                                DateTimeValue(DatePickerDobIkkeFnr.SelectedDate),
                                                Now(),
                                                TimeUnit.Days
                                            ) / 365.25,
                                            0
                                        ),
                                        SysVak,
                                        "",
                                        RecordKey,
                                        ThisRecord.Value
                                    )
                                )
                              OnChange: |-
                                =// Velger time
                                If(
                                    Self.EventName = "CellAction" And Self.EventColumn = "SysVak",
                                    UpdateContext(
                                        {
                                            SysVakResponse: Vaksinering.hentcovidvaksineringer(Self.EventRowKey).immunizations,
                                            showPanelSysVak: true
                                        }
                                    );
                                );
                                If(
                                    Self.EventName = "OnRowSelectionChange",
                                    UpdateContext(
                                        {
                                            SelectedPerson: PersonTabell.Selected
                                        }
                                    );
                                );
                              OnSelect: =Notify("Valgt ny OnSelect")
                              RaiseOnRowSelectionChangeEvent: =true
                              SelectRowsOnFocus: =
                              SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.Single
                              Theme: =AppThemeJson
                              columns_Items: |-
                                =Table(
                                    {
                                        ColName: "Navn",
                                        ColDisplayName: "Navn",
                                        ColWidth: 300,
                                        ColSortable: true,
                                        ColIsBold: true,
                                        ColResizable: true
                                    },
                                    {
                                        ColName: "Dob",
                                        ColDisplayName: "Født",
                                        ColWidth: 100,
                                        ColSortable: true,
                                        ColIsBold: true,
                                        ColResizable: true
                                    },
                                    {
                                        ColName: "Mobil",
                                        ColDisplayName: "Mobil",
                                        ColWidth: 100,
                                        ColSortable: true,
                                        ColIsBold: true,
                                        ColResizable: true
                                    },
                                    {
                                        ColName: "Epost",
                                        ColDisplayName: "Epost",
                                        ColWidth: 200,
                                        ColSortable: true,
                                        ColIsBold: true,
                                        ColResizable: true
                                    },
                                     {
                                        ColName: "Alder",
                                        ColDisplayName: "Alder",
                                        ColWidth: 100,
                                        ColSortable: true,
                                        ColIsBold: true,
                                        ColResizable: true
                                    }, 
                                    {
                                        ColName: "SysVak",
                                        ColDisplayName: "SysVak",
                                        ColWidth: 100,
                                        ColSortable: true,
                                        ColIsBold: true,
                                        ColResizable: true,
                                        ColCellType: "link"
                                    }
                                    )
                  - HeaderContainerSearch:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        BorderThickness: =1
                        FillPortions: =0
                        Height: =32
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                      Children:
                        - SearchBox1:
                            Control: CodeComponent
                            ComponentName: cat_PowerCAT.SearchBox
                            Properties:
                              Height: =30
                              PlaceHolderText: ="Søk på navn"
                              Width: =175
                        - DropdownDato:
                            Control: Classic/DatePicker@2.6.0
                            Properties:
                              BorderColor: =RGBA(166, 166, 166, 1)
                              Color: =RGBA(51, 51, 51, 1)
                              DisabledBorderColor: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Segoe UI'
                              Format: ="dd.mm.yyyy"
                              Height: =30
                              IconBackground: =RGBA(0, 120, 212, 1)
                              IconFill: =RGBA(255, 255, 255, 1)
                              OnChange: =If(DropdownDato.SelectedDate < Today() - 5 And Ansattvaksinering, Reset(DropdownDato); Notify("Det er ikke tillat å se lengre tilbake i tid enn 5 dager", NotificationType.Error););
                              PaddingTop: =5
                              Size: =10
                              StartOfWeek: =StartOfWeek.Monday
                              StartYear: =2023
                              Width: =150
                        - CheckKunIdag:
                            Control: CheckBox@0.0.30
                            Properties:
                              BasePaletteColor: =RGBA(106, 122, 127, 1)
                              Height: |+
                                =30
                              Label: ="Kun dagens"
                        - ComboboxStatus:
                            Control: ComboBox@0.0.51
                            Properties:
                              DefaultSelectedItems: =Choices(Statusfortimeavtale)
                              InputTextPlaceholder: =""
                              Items: |-
                                =Choices(Statusfortimeavtale)
                                //Choices(Vaksinekategori)
                              SelectMultiple: =true
                              X: =564
                              Y: =52
                        - IconSkille:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(0, 18, 107, 1)
                              Height: =32
                              Icon: =Icon.VerticalLine
                              Width: =5
                        - ComboboxKategori:
                            Control: ComboBox@0.0.51
                            Properties:
                              DefaultSelectedItems: |-
                                =If(Innbyggervaksinering,
                                {Value: Vaksinekategori.Korona},
                                {Value: Vaksinekategori.Influensa})
                              InputTextPlaceholder: =""
                              Items: |+
                                =//If(Innbyggervaksinering,
                                Choices(Vaksinekategori)
                                //Filter(Choices(Vaksinekategori),ThisRecord.Value = "demo")
                                // Items på Dropdown/ComboBox
                                /*[
                                            'Vaksinekategori'.'Hepatitt A',
                                            'Vaksinekategori'.'Meningokokk A',
                                            'Vaksinekategori'.'Meningokokk B',
                                            'Vaksinekategori'.Influensa,
                                            'Vaksinekategori'.Korona,
                                            'Vaksinekategori'.Mpox
                                        ]*/
                              Width: =150
                        - IconSkille_1:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(0, 18, 107, 1)
                              Height: =32
                              Icon: =Icon.VerticalLine
                              Width: =5
                        - ComboboxCanvasTimebok:
                            Control: ComboBox@0.0.51
                            Properties:
                              DefaultSelectedItems: |+
                                =If(Innbyggervaksinering,
                                {Value: TimeboktypeChoice.Timeavtale},
                                {Value: TimeboktypeChoice.DropIn})
                              InputTextPlaceholder: =""
                              Items: =Choices(TimeboktypeChoice)
                              SelectMultiple: =true
                              Width: =150
                              X: =40
                              Y: =40
                            Children:
                              - Value2:
                                  Control: ComboBoxDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Value"
                                    FieldName: ="Value"
                                    FieldType: ="l"
                                    Order: =1
                        - IconSkille_2:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(0, 18, 107, 1)
                              Height: =32
                              Icon: =Icon.VerticalLine
                              Width: =5
                        - ButtonEnkelttime:
                            Control: Button@0.0.45
                            Properties:
                              DisplayMode: |-
                                =DisplayMode.Edit
                                //If(IsBlank(SelectedPerson.Value),DisplayMode.Disabled,DisplayMode.Edit)
                              Height: =30
                              OnSelect: |-
                                =UpdateContext(
                                    {
                                        showEnkelttime:true
                                    }
                                )
                              Text: |-
                                =If(
                                    IsBlank(SelectedPerson.Value),
                                    "Opprett en tom time",
                                    $"Opprett time for {SelectedPerson.Navn}"
                                )
                                // & " for " & DropdownKategori.Selected.Value & "(" & DropdownTimebok.Selected.Value & ")"
                              Width: =350
                        - IconSkille_3:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(0, 0, 0, 0)
                              Height: =32
                              Icon: =Icon.VerticalLine
                              Width: =10
                        - ButtonManuellRegistrering:
                            Control: Button@0.0.45
                            Properties:
                              BasePaletteColor: =//If(manuellRegistrering,RGBA(255, 0, 0, 1))
                              DisplayMode: |-
                                =DisplayMode.Edit
                                //If(IsBlank(SelectedPerson.Value),DisplayMode.Disabled,DisplayMode.Edit)
                              Height: =30
                              OnSelect: |-
                                =If(
                                    manuellRegistrering,
                                    UpdateContext({ manuellRegistrering:false }),
                                    UpdateContext({ showManuellRegistreringBekreft:true })
                                )
                              Text: ="Manuell registrering"
                              Width: =350
                  - Container5:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        LayoutDirection: =LayoutDirection.Vertical
                      Children:
                        - TimeavtaleTabell:
                            Control: CodeComponent
                            ComponentName: cat_PowerCAT.FluentDetailsList
                            Properties:
                              AlignInContainer: =AlignInContainer.Stretch
                              AlternateRowColor: ="#f7f7f7"//AppTheme.palette.neutralTertiaryAlt
                              ColRowHeader: =""
                              ColSortable: =""
                              FillPortions: =1
                              Items: |-
                                =AddColumns(
                                    If(
                                        CheckKunIdag.Checked = true,
                                        Filter(
                                            SortByColumns(
                                                Vaksinerings,
                                                "sogv_timeavtale",
                                                SortOrder.Ascending
                                            ),
                                            Timeavtale >= If(
                                                CheckboxCanvas1.Checked,
                                                DateAdd(
                                                    DropdownDato.SelectedDate,
                                                    12,
                                                    TimeUnit.Hours
                                                ),
                                                DropdownDato.SelectedDate
                                            ) And Timeavtale <= DateAdd(
                                                DropdownDato.SelectedDate,
                                                1
                                            ) And ThisRecord.'Hovedtype vaksine' = ComboboxKategori.Selected.Value And ThisRecord.Timeboktype in ComboboxCanvasTimebok.SelectedItems 
                                            //ThisRecord.Timeboktype = DropdownTimebok.Selected.Value 
                                And ThisRecord.Account.Account = GUID(TabListAccount.Selected.Account) And ThisRecord.'Status for timeavtale' in ComboboxStatus.SelectedItems And (SearchBox1.SearchText in Name Or SearchBox1.SearchText in Fnr) And ThisRecord.Status = 0 And (ThisRecord.reservertTid < Now() Or IsBlank(ThisRecord.reservertTid))
                                        ),
                                        Filter(
                                            SortByColumns(
                                                Vaksinerings,
                                                "sogv_timeavtale",
                                                SortOrder.Ascending
                                            ),
                                            Timeavtale >= If(
                                                CheckboxCanvas1.Checked,
                                                DateAdd(
                                                    DropdownDato.SelectedDate,
                                                    12,
                                                    TimeUnit.Hours
                                                ),
                                                DropdownDato.SelectedDate
                                            ) And ThisRecord.'Hovedtype vaksine' = ComboboxKategori.Selected.Value And ThisRecord.Timeboktype in ComboboxCanvasTimebok.SelectedItems 
                                            //ThisRecord.Timeboktype = DropdownTimebok.Selected.Value 
                                And ThisRecord.Account.Account = GUID(TabListAccount.Selected.Account) And ThisRecord.'Status for timeavtale' in ComboboxStatus.SelectedItems And (SearchBox1.SearchText in Name Or SearchBox1.SearchText in Fnr) And ThisRecord.Status = 0 And (ThisRecord.reservertTid < Now() Or IsBlank(ThisRecord.reservertTid))
                                        )
                                    ),
                                    InnbyggerbooketCol,
                                    If(
                                        //Første del (altså før Or) kan slettes etter hvert, kanskje fra 30.10.2023
                                        ThisRecord.'(Deprecated) BooketAvIInnbygger' = true Or Not(IsBlank(ThisRecord.'Booket av innbygger')),
                                        "🤖"
                                    ),
                                    VaksineringStatusCol,
                                    If(
                                        ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'⚪Opptatt',// 408591000,
                                        "Registrer oppmøte",
                                        If(
                                            ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🟡Møtt opp',// 408592000,
                                            "Avvis avtale"
                                        )
                                    ),
                                    FDatoCol,
                                    If(
                                        Not(IsBlank(ThisRecord.Fnr)),
                                        Left(
                                            ThisRecord.Fnr,
                                            2
                                        ) & "." & Mid(
                                            ThisRecord.Fnr,
                                            3,
                                            2
                                        ) & "." & Mid(
                                            ThisRecord.Fnr,
                                            5,
                                            2
                                        ) & If(
                                            Not(IsBlank(ThisRecord.Alder)),
                                            " (" & ThisRecord.Alder & ")"
                                        )
                                    ),
                                    Vaksiner,
                                    If(
                                        ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🟢Vaksinert',
                                        "☑️",//Blue tick Emoji
                                        If(
                                            (ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'⚪Opptatt' Or ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🟡Møtt opp'),
                                            If(
                                                //manuellRegistrering Or CountRows(ThisRecord.'Customer Voice survey responses') > 0,
                                                manuellRegistrering Or Not(IsBlank(ThisRecord.triageTid)),
                                                "💉",//Sprøyte Emoji
                                                "📝"//Ark Emoji
                                            )
                                        )
                                    ),
                                    Timeavtale2,
                                    If(
                                        CheckKunIdag.Checked,
                                        Text(
                                            ThisRecord.Timeavtale,
                                            "hh:mm"
                                        ),
                                        Text(
                                            ThisRecord.Timeavtale,
                                            "dd.mm.yyyy hh:mm"
                                        )
                                    ),
                                    CV,
                                    If(
                                        Not(IsBlank(ThisRecord.Fnr)) And 
                                        (
                                            (
                                                Not(ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🟢Vaksinert') And 
                                                Not(ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🟩Vaksinert og sendt til Sysvak')
                                            ) Or 
                                            Not(IsBlank(ThisRecord.'Manuell CV Tid'))
                                        ),
                                        ThisRecord.'Survey invitation URL'
                                    ),
                                    AntallCV,
                                    If(
                                        Not(IsBlank(ThisRecord.Fnr)),
                                        If(
                                            //CountRows(ThisRecord.'Customer Voice survey responses') > 0,
                                            Not(IsBlank(ThisRecord.triageTid)),
                                            /*Text(
                                                Last(ThisRecord.'Customer Voice survey responses').'Submit date',
                                                "dd.mm.yyyy"
                                            ),*/
                                            "Se siste",
                                            If(
                                                Not(IsBlank(ThisRecord.'Manuell CV Tid')),
                                                /*Text(
                                                    ThisRecord.'Manuell CV Tid',
                                                    "dd.mm.yyyy"
                                                ) & " (M)"*/
                                                "Se siste (M)"
                                            )
                                        )
                                    ),
                                    'Merknad ',
                                    If(
                                        Not(IsBlank(ThisRecord.Fnr)),
                                        If(
                                            IsBlank(ThisRecord.Merknad),
                                            "Legg til merknad",
                                            ThisRecord.Merknad
                                        )
                                    ),
                                    Journal,
                                    If(
                                        Not(IsBlank(ThisRecord.Fnr)),
                                        "Legg til journal"
                                    ),
                                    JournalListe,
                                    If(
                                        ThisRecord.'Har notat',
                                   //     CountRows(ThisRecord.Notes) > 0,
                                        "Se notater"
                                    ),
                                    Booking,
                                    If(
                                        ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🆓Ledig',
                                        "Book time",
                                        If(
                                            ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'⚪Opptatt' Or ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🟡Møtt opp',
                                            "Avlys time"
                                        )
                                    ),
                                    Mobilnummer,
                                    If(
                                        Not(ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🆓Ledig'),
                                        If(
                                            Not(IsBlank(ThisRecord.MobilNummer)),
                                            ThisRecord.MobilNummer,
                                            "Velg mobil"
                                        )
                                    ),
                                    NavnCustom,
                                    If(
                                        IsBlank(ThisRecord.'Manuell Registrering Tid'),
                                        ThisRecord.Name,
                                        ThisRecord.Name & " (M)"
                                    ),
                                    triagegruppe,Triagegruppe,
                                    RecordKey,
                                    ThisRecord.Vaksinering
                                )
                              OnChange: |
                                =If(
                                    Self.EventName = "CellAction",
                                    //TRYKKET PÅ EN LINK/IMAGELINK
                                    UpdateContext(
                                        {
                                            CurrentAvtale: LookUp(
                                                Vaksinerings,
                                                Vaksinering = GUID(Self.EventRowKey)
                                            )
                                        }
                                    );
                                    If(// ***Endre status NEW***
                                        Self.EventColumn = "sogv_vaksineringstatus",
                                        UpdateContext({showStatus: true})
                                    );
                                    If(// *** Endre Møtt opp ***
                                        Self.EventColumn = "VaksineringStatusCol",
                                        If(
                                            CurrentAvtale.'Status for timeavtale' = 408591000,
                                            Patch(
                                                Vaksinerings,
                                                CurrentAvtale,
                                                {'Status for timeavtale': Statusfortimeavtale.'🟡Møtt opp'}
                                            )
                                        );
                                        If(
                                            CurrentAvtale.'Status for timeavtale' = 408592000,
                                            UpdateContext({showAvvis: true})
                                        )
                                    );
                                    If(// *** Ny Customer Voice ***
                                        Self.EventColumn = "CV",
                                        UpdateContext({showPanel_CV: true})
                                    );
                                    If(//VIS FNR
                                        Self.EventColumn = "FDatoCol",
                                        UpdateContext({showFnr: true})
                                    );
                                    If(//Endre avtale
                                        Self.EventColumn = "Timeavtale2",
                                        If(
                                            Not(CurrentAvtale.'Status for timeavtale' = Statusfortimeavtale.'🟢Vaksinert' Or CurrentAvtale.'Status for timeavtale' = Statusfortimeavtale.'🟩Vaksinert og sendt til Sysvak'),
                                            UpdateContext({showEndre: true}),
                                            Notify(
                                                "Kan ikke endre tidspunkt for vaksinert avtale",
                                                NotificationType.Error,
                                                3000
                                            )
                                        )
                                    );
                                    If(//EKSISTERENDE CV
                                        Self.EventColumn = "AntallCV",
                                        If(
                                            //CountRows(CurrentAvtale.'Customer Voice survey responses') > 0,
                                            Not(IsBlank(CurrentAvtale.triageTid)),
                                            UpdateContext({showPanel_CV2: true}),
                                            If(
                                                IsBlank(CurrentAvtale.'Manuell CV Tid'),
                                                Notify(
                                                    "Fant ikke egenerklææring",
                                                    NotificationType.Error,
                                                    3000
                                                ),
                                                Notify(
                                                    "Denne egenerklæringen ble registrert manuelt",
                                                    NotificationType.Information,
                                                    3000
                                                )
                                            )
                                        )
                                    );
                                    If(//SKRIV MERKNAD
                                        Self.EventColumn = "Merknad ",
                                        UpdateContext({showMerknad: true});
                                    );
                                    If(//SKRIV JOURNAL
                                        Self.EventColumn = "Journal",
                                        Notify(
                                            "Journalnotat skal kun inneholde de opplysninger som er nødvendige for å dokumentere den helsehjelpen som er gitt. Helseopplysninger kan skrives her, men vær varsom med detaljer og mengden informasjon.",
                                            NotificationType.Information,
                                            0
                                        );
                                        UpdateContext({showJournal: true});
                                    );
                                    If(//REDIGER MOBILNUMMER
                                        Self.EventColumn = "Mobilnummer",
                                        UpdateContext({showMobil: true});
                                    );
                                    If(//GJENNOMFØR VAKSINERING
                                        Self.EventColumn = "Vaksiner",
                                        If(
                                            Not(IsBlank(CurrentAvtale.Fnr)),
                                            If(
                                                manuellRegistrering,
                                                If(
                                                    //CountRows(CurrentAvtale.'Customer Voice survey responses') > 0 Or Not(IsBlank(CurrentAvtale.'Manuell CV Tid')),
                                                    Not(IsBlank(CurrentAvtale.triageTid)) Or Not(IsBlank(CurrentAvtale.'Manuell CV Tid')),
                                                   // Reset(MerknadInput);
                                                    UpdateContext({showVaksinering: true}),
                                                    If(
                                                        IsBlank(CurrentAvtale.'Manuell CV Tid'),
                                                        UpdateContext({showBekreftManuellCV: true}),
                                                        UpdateContext({showVaksinering: true})
                                                    )
                                                ),
                                                If(
                                                    IsBlank(CurrentAvtale.'Manuell Registrering Tid'),
                                                    If(
                                                        //CountRows(CurrentAvtale.'Customer Voice survey responses') > 0,
                                                        Not(IsBlank(CurrentAvtale.triageTid)),
                                                        UpdateContext({showVaksinering: true}),
                                                        Notify(
                                                            "Før du registrerer vaksinen må egenerklæring være fyllt ut",
                                                            NotificationType.Information
                                                        );
                                                        UpdateContext({showPanel_CV: true})
                                                    ),
                                                    Notify(
                                                        "Denne vaksineringen ble registrert manuelt. Endre til manuell registrering for å åpne den.",
                                                        NotificationType.Error,
                                                        3000
                                                    );
                                                )
                                            )
                                        );
                                    );
                                    If(//VIS JUOURNAL LISTE
                                        Self.EventColumn = "JournalListe",
                                        UpdateContext(
                                            {
                                                journalListHTML: Concatenate(
                                                    "<hr>",
                                                    Concat(
                                                        ForAll(
                                                            CurrentAvtale.Notes,
                                                            Concatenate(
                                                                "<h3 style='color:#447eeb'>",
                                                                ThisRecord.Title,
                                                                "</h3><h4 style='color:#88b1fc'>",
                                                                Text(
                                                                    ThisRecord.'Created On',
                                                                    "dd.mm.yyyy HH:mm"
                                                                ),
                                                                "</h4><p>",
                                                                ThisRecord.Description,
                                                                "</p><h3><hr>"
                                                            )
                                                        ),
                                                        ThisRecord.Value
                                                    )
                                                ),
                                                showJournalList: true
                                            }
                                        )
                                    );
                                    If(//BOOK TIME
                                        Self.EventColumn = "Booking",
                                        If(
                                            Not(CurrentAvtale.'Status for timeavtale' = Statusfortimeavtale.'🟢Vaksinert' Or CurrentAvtale.'Status for timeavtale' = Statusfortimeavtale.'🟩Vaksinert og sendt til Sysvak'),
                                            If(
                                                CurrentAvtale.'Status for timeavtale' = Statusfortimeavtale.'🆓Ledig',
                                                If(
                                                    IsBlank(SelectedPerson),
                                                    If(
                                                        manuellRegistrering,
                                                        UpdateContext({showBookTimeReserve: true}),
                                                        Notify("Velg en person før du velger avtale")
                                                    ),
                                                    UpdateContext({showBookTime: true})
                                                ),
                                                UpdateContext({showAvbestillTime: true})
                                            ),
                                            Notify("Denne timeavtalen er vaksinert, og kan ikke bookes eller avbestilles")
                                        )
                                    )
                                );
                              PageSize: =900
                              SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                              Theme: =AppThemeJson
                              Width: =1000
                              columns_Items: "=Table(\n    {\n        ColName: \"sogv_triagegruppe\",\n        ColDisplayName: \"\",\n        ColWidth: 15,\n        ColSortable: true,\n        ColIsBold: true,\n        ColResizable: true\n    },\n    {\n        ColName: \"sogv_vaksineringstatus\",\n        ColDisplayName: \"\",\n        ColWidth: 15,\n        ColSortable: true,\n        ColIsBold: true,\n        ColResizable: true\n   //     ColCellType: \"link\"\n    },\n    {\n        ColName: \"Timeavtale2\",\n        ColDisplayName: \"Tidspunkt\",\n        ColWidth:\n            If(\n                CheckKunIdag.Checked,\n                55,\n                100\n            ),\n        ColSortable: true,\n        ColIsBold: true,\n        ColResizable: true,\n        ColCellType: \"link\"\n    },\n    {\n        ColName: \"InnbyggerbooketCol\",\n        ColDisplayName: \"\",\n        ColWidth: 15,\n        ColSortable: true,\n        ColResizable: true\n    },\n    {\n        ColName: \"NavnCustom\",\n        ColDisplayName: \"Navn\",\n        ColWidth: 200,\n        ColSortable: true,\n        ColIsBold: true,\n        ColResizable: true\n    },\n    {\n        ColName: \"FDatoCol\",\n        ColDisplayName: \"Fødselsdato\",\n        ColCellType: \"link\",\n        ColWidth: 80\n    },\n    {\n        ColName: \"Booking\",\n        ColDisplayName: \"Book/avbestill\",\n        ColCellType: \"link\",\n        ColWidth: 105\n    },\n    {\n        ColName: \"VaksineringStatusCol\",\n      //  ColName: \"sogv_vaksineringstatus\",\n        ColDisplayName: \"Endre status\",\n        ColCellType: \"link\",\n        ColWidth: 100\n    },\n    {\n        ColName: \"Merknad \",\n        ColDisplayName: \"Merknad \",\n        ColSortable: true,\n        ColWidth: 100,\n        ColIsBold: true,\n        ColCellType: \"link\"\n    },\n    {\n        ColName: \"CV\",\n        ColDisplayName: \"Ny egenerklæring\",\n        ColSortable: true,\n        ColWidth: 100,\n        ColIsBold: true,\n        ColCellType: \"link\"\n    },\n    {\n        ColName: \"AntallCV\",\n        ColDisplayName: \"Siste egenerklæring\",\n        ColSortable: true,\n        ColWidth: 140,\n        ColIsBold: true,\n        ColCellType: \"link\"\n    },\n   // {\n   //     ColName: \"sogv_merknad\",\n   //     ColDisplayName: \"Merknad:\",\n   //     ColShowAsSubTextOf: \"sogv_name\",\n   //     ColLabelAbove: false,\n   //     ColIsBold: true,\n   //     ColSubTextRow: 1\n   // },\n    //{\n    //    ColName: \"VelgAvtale\",\n    //    ColDisplayName: \"Velg avtale\",\n    //    ColCellType: \"clickableimage\",\n    //    ColWidth: 100\n    //},\n    {\n        ColName: \"Journal\",\n        ColDisplayName: \"Journal\",\n        ColWidth: 100,\n        ColIsBold: true,\n        ColCellType: \"link\"\n    },\n    {\n        ColName: \"JournalListe\",\n        ColDisplayName: \"Journalnotater\",\n        ColWidth: 100,\n        ColIsBold: true,\n        ColCellType: \"link\"\n    },\n    {\n        ColName: \"Vaksiner\",\n        ColDisplayName: \"Vaksineregistering\",\n        //ColCellType: \"clickableimage\",\n        ColCellType: \"link\",\n        ColWidth: 100\n    }/*,\n    {\n        ColName: \"AvlysMedSMS\",\n        ColDisplayName: \"Avlys/booking\",\n        ColCellType: \"link\",\n        ColWidth: 92\n    },\n    {\n        ColName: \"AvlysUtenSMS\",\n        ColDisplayName: \"Avlys\",\n        ColCellType: \"link\",\n        ColWidth: 30\n    }*/,\n    {\n        ColName: \"Mobilnummer\",\n        ColDisplayName: \"Mobilnummer\",\n        ColCellType: \"link\",\n        ColWidth: 90\n    },\n    {\n        ColName: \"sogv_hovedtypevaksine\",\n        ColDisplayName: \"Hovedtype\",\n        ColSortable: true,\n        ColWidth: 100,\n        ColIsBold: true,\n        ColResizable: true\n    },\n    {\n        ColName: \"sogv_Vaksinetype\",\n        ColDisplayName: \"Vaksinetype\",\n        ColSortable: true,\n        ColWidth: 100,\n        ColIsBold: true,\n        ColResizable: true\n    },\n    {\n        ColName: \"sogv_timeboktype\",\n        ColDisplayName: \"Timebok\",\n        ColSortable: true,\n        ColWidth: 100,\n        ColIsBold: true,\n        ColResizable: true\n    }\n    \n)"
                  - Container3:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        FillPortions: =0
                        Height: =40
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        Width: =Parent.Width
                      Children:
                        - Label5:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              AlignInContainer: =AlignInContainer.Start
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Height: =Parent.Height/2
                              Size: =11
                              Text: |-
                                =Triagegruppe.'⚠️'&
                                " - Triage"&
                                "           "&

                                "⚪"&
                                " - Opptatt time"&
                                "           "&

                                "🟡"&
                                " - Oppmøte registrert"&
                                "           "&

                                "🟢/☑️"&
                                " - Registrert vaksine"&
                                "           "&

                                "🔴"&
                                " - Avvist"



                                /*

                                            "icon:checkmark",
                                            If(
                                                CountRows(ThisRecord.'Customer Voice survey responses') > 0,
                                                "icon:hospital",
                                                "icon:removefromshoppinglist"
                                            )
                                        )
                                    ),
                                    "Timeavtale2",
                                    If(
                                        ThisRecord.'Vaksine er satt' = true,
                                        "🟢 ",
                                        "⚪ "

                                */
                              Width: =Parent.Width
                        - Label5_1:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              AlignInContainer: =AlignInContainer.Start
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Height: =Parent.Height/2
                              Size: =11
                              Text: |-
                                ="💉"&
                                " - Registrer vaksine"&
                                "           "&

                                "🤖"&
                                " - Innbyggerbooking"&
                                "           "&

                                "📝"&
                                " - Mangler egenerklæring"&
                                "           "

                                /*

                                            "icon:checkmark",
                                            If(
                                                CountRows(ThisRecord.'Customer Voice survey responses') > 0,
                                                "icon:hospital",
                                                "icon:removefromshoppinglist"
                                            )
                                        )
                                    ),
                                    "Timeavtale2",
                                    If(
                                        ThisRecord.'Vaksine er satt' = true,
                                        "🟢 ",
                                        "⚪ "

                                */
                              Width: =Parent.Width
      - Panel_CV2:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_CV_NyeEgenerklæring
          Properties:
            Buttons: |-
              =//Table({Label: "Cancel", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true } ,{Label: "Ok", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true })
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_CV2.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =//UpdateContext({showPanel_CV: false});UpdateContext({CvSource: Blank()});
              UpdateContext({showPanel_CV: false});UpdateContext({CurrentAvtale: Blank()});Refresh(Vaksinerings)
            OnCloseSelect: |-
              =UpdateContext({showPanel_CV: false});UpdateContext({CurrentAvtale: Blank()})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: '="Egenerklæring" '
            Theme: =AppTheme
            Title: =CurrentAvtale.Name
            Visible: =showPanel_CV
            Width: =App.Width
            X: =
      - responsiveIframeCv2:
          Control: CodeComponent
          ComponentName: nd_NghiemDoan.responsiveIframePCFControl
          Group: Panel_CV_NyeEgenerklæring
          Properties:
            Height: =Panel_CV2.Height-Self.Y
            Visible: =Panel_CV2.Visible
            Width: =Panel_CV2.DialogWidth
            X: =Panel_CV2.ContentX
            Y: =Panel_CV2.ContentY + 15
            source: =CurrentAvtale.'Survey invitation URL'
      - Panel_Merknad:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Merknad_Group
          Properties:
            Buttons: |-
              =Table({Label: "Avbryt", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true } ,{Label: "Lagre", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true })
            Description: =""
            DialogWidth: =App.Width / 3
            Fill: =Panel_Book_1.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =Switch(
                  Self.SelectedButton.Label,
                  "Lagre",
                  If(
                      Len(MerknadInput.Text) > 100,
                      Notify(
                          $"Maks antall tegn er 100. Du har brukt {Len(MerknadInput.Text)}. Vennligst korriger og lagre på ny.",
                          NotificationType.Error
                      ),
                      If(
                          IsError(
                              Patch(
                                  Vaksinerings,
                                  CurrentAvtale,
                                  {Merknad: MerknadInput.Text}
                              )
                          ),
                      // Error
                          Notify(
                              "Lagring av merknad feilet",
                              NotificationType.Error,
                              0
                          ),
                      //Sucess
                          Notify(
                              $"Merknad lagret: {CurrentAvtale.Name}",
                              NotificationType.Success
                          );
                          Reset(MerknadInput);
                          UpdateContext({showMerknad: false})
                      )
                  ),
                  Reset(MerknadInput);
                  UpdateContext({showMerknad: false})
              )
            OnCloseSelect: |-
              =UpdateContext({showMerknad: false})
            OverlayColor: =RGBA(33, 33, 29, 0.36)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: ="Merknad"
            Theme: =AppTheme
            Title: =CurrentAvtale.Name
            Visible: =showMerknad
            Width: =App.Width
      - Panel_CV_Eksisterende:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_CV_Eksisterende_Group
          Properties:
            Buttons: |-
              =Table({Label: "Cancel", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true } ,{Label: "Ok", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true })
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_CV_Eksisterende.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =//UpdateContext({showPanel_CV2: false});UpdateContext({CvSource2: Blank()});
              UpdateContext({showPanel_CV2: false});UpdateContext({CurrentAvtale: Blank()})// Refresh(Vaksinerings)
            OnCloseSelect: |-
              =//UpdateContext({showPanel_CV2: false});UpdateContext({CvSource2: Blank()});
              UpdateContext({showPanel_CV2: false});UpdateContext({CurrentAvtale: Blank()})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: ="Siste egenerklæring (" & Text(Last(CurrentAvtale.'Customer Voice survey responses').'Date Created',"dd.mm.yyyy HH:mm") & ")"
            Theme: =AppTheme
            Title: = CurrentAvtale.Name
            Visible: =showPanel_CV2
            Width: =App.Width
            X: =
      - Panel_JournalNotat:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Journal_Group
          Properties:
            Buttons: |-
              =Table(
                  {Label: "Avbryt", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true },
                  {Label: "Lagre", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:Len(PlainText(RichTextEditor1.HtmlText)) > 0 }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_JournalNotat.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =Switch(
                  Self.SelectedButton.Label,
                  "Lagre",
                  If (
                      Len(PlainText(RichTextEditor1.HtmlText)) > 1000,
                      Notify(
                          $"Maks antall tegn er 1000, du har benyttet {Len(PlainText(RichTextEditor1.HtmlText))}. Korriger og lagre på ny.",
                          NotificationType.Error
                      ),
                      Patch(
                          Notes,
                          Defaults(Notes),
                          {
                              Title: "Journalnotat",
                              //Description: TextInput_Merknad_1.Text;
                              Description: RichTextEditor1.HtmlText,
                              Regarding: CurrentAvtale,
                              'Is Document': false
                          }
                      );
                      Patch(
                          Vaksinerings,
                          CurrentAvtale,
                          {'Har notat': true}
                      );
                      If(
                      // check if there were any errors when the test score was submitted
                          !IsEmpty(Errors(Notes)),
                      // if true, show any error message
                          Notify(
                              "Lagring journalnotat feilet",
                              NotificationType.Error
                          ),
                      // else, go to success screen
                          Notify(
                              "Jornalnotat er registrert på: " & CurrentAvtale.Name,
                              NotificationType.Success,
                              3000
                          )
                      );
                      UpdateContext({showJournal: false});
                      Reset(RichTextEditor1)
                  ),
                  "Avbryt",
                  UpdateContext({showJournal: false});
                  Reset(RichTextEditor1)
              )
            OnCloseSelect: |-
              =UpdateContext({showJournal: false});RichTextEditor1.HtmlText=""
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: ="Nytt journalnotat (1000 tegn)"
            Theme: =AppTheme
            Title: =CurrentAvtale.Name
            Visible: =showJournal
            Width: =App.Width
      - FluentDetailsList5:
          Control: CodeComponent
          ComponentName: cat_PowerCAT.FluentDetailsList
          Group: Panel_CV_Eksisterende_Group
          Properties:
            Height: =Panel_CV_Eksisterende.ContentHeight
            Items: |-
              =Sort(
                  AddColumns(
                      Table(ParseJSON(Last(CurrentAvtale.'Customer Voice survey responses').'Details of the Survey Response')),
                      sporsmaal,
                      LookUp(
                          'Customer Voice survey  questions',
                          'Source question identifier' = Text(Value.questionId) And 'Source survey identifier' = Last(CurrentAvtale.'Customer Voice survey responses').'Source survey identifier',
                          'Question text'
                      ),
                      Svar,
                      Text(Value.response),
                      RowNumber,
                      0
                  ),
                  LookUp(
                      'Customer Voice survey  questions',
                      'Source question identifier' = Text(Value.questionId),
                      Sequence
                  ),
                  SortOrder.Ascending
              )
            Visible: =Panel_CV_Eksisterende.Visible
            Width: =Panel_CV_Eksisterende.DialogWidth
            X: =Panel_CV_Eksisterende.ContentX
            Y: =Panel_CV_Eksisterende.ContentY+20
            columns_Items: |-
              =Table(
                   {
                      ColName: "sporsmaal",
                      ColDisplayName: "Spørsmål",
                      ColWidth: FluentDetailsList5.Width-200,
                      ColSortable: true,
                      ColIsBold: true,
                      ColResizable: true,
                      ColMultiLine: true,
                      AlternateRowColor: "ff0000"
                  }, {
                      ColName: "Svar",
                      ColDisplayName: "Svar",
                      ColWidth: 100,
                      ColSortable: true,
                      ColIsBold: true,
                      ColResizable: true,
                      ColMultiLine: true
                  }
              )
      - Panel_Sysvak:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Sysvak_Group
          Properties:
            Buttons: |-
              =Table(
                  {Label: "Ok", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Sysvak.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =UpdateContext(
                  {
                      showPanelSysVak: false,
                      SysVakResponse: Blank()
                  }
              )
            OnCloseSelect: |-
              =UpdateContext(
                  {
                      showPanelSysVak: false,
                      SysVakResponse: Blank()
                  }
              );
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Vaksiner hentet fra sysvak"
            Visible: =showPanelSysVak
            Width: =App.Width
            X: =
      - RichTextEditor1:
          Control: RichTextEditor@2.7.0
          Group: Panel_Journal_Group
          Properties:
            BorderColor: =RGBA(0, 0, 0, 0.22)
            Default: =""
            Height: =Panel_JournalNotat.ContentHeight
            Visible: =Panel_JournalNotat.Visible
            Width: =Panel_JournalNotat.DialogWidth-40
            X: =Panel_JournalNotat.ContentX+20
            Y: =Panel_JournalNotat.ContentY+30
      - FluentDetailsList4:
          Control: CodeComponent
          ComponentName: cat_PowerCAT.FluentDetailsList
          Group: Panel_Sysvak_Group
          Properties:
            AlternateRowColor: ="#f7f7f7"
            Height: =Panel_Sysvak.ContentHeight
            Items: |-
              =AddColumns(
                  SysVakResponse,
                  col1,
                  Text(
                      DateValue (ThisRecord.vaccinationDate),
                      "dd.mm.yyyy"
                  ),
                  col2,
                  ThisRecord.recorder.name,
                  col3,
                  ThisRecord.vaccineCode.display,
                  Covid,
                  If(Not(IsBlank(ThisRecord.vaccineCode.display)),"🟢")
              )
            Visible: =Panel_Sysvak.Visible
            Width: =Panel_Sysvak.DialogWidth
            X: =Panel_Sysvak.ContentX
            Y: =Panel_Sysvak.ContentY + 12
            columns_Items: |-
              =Table(
                  {
                      ColName: "col1",
                      ColDisplayName: "Vaksinedato",
                      ColWidth: FluentDetailsList4.Width / 6,
                      ColSortable: true,
                      ColIsBold: true,
                      ColResizable: true
                  },
                  {
                      ColName: "col2",
                      ColDisplayName: "Enhet",
                      ColWidth: FluentDetailsList4.Width / 6,
                      ColSortable: true,
                      ColIsBold: true,
                      ColResizable: true
                  },
                  {
                      ColName: "col3",
                      ColDisplayName: "Vaksinetype",
                      ColWidth: FluentDetailsList4.Width / 6,
                      ColSortable: true,
                      ColIsBold: true,
                      ColResizable: true
                  },
                  {
                      ColName: "lotNumber",
                      ColDisplayName: "Batch",
                      ColWidth: FluentDetailsList4.Width / 6,
                      ColSortable: true,
                      ColIsBold: true,
                      ColResizable: true
                  },
                  {
                      ColName: "Covid",
                      ColDisplayName: "Type korona",
                      ColWidth: FluentDetailsList4.Width / 6,
                      ColSortable: true,
                      ColIsBold: true,
                      ColResizable: true
                  }
              )
      - Container2:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Merknad_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Merknad.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =Panel_Merknad.Visible
            Width: =Panel_Merknad.ContentWidth
            X: =Panel_Merknad.ContentX
            Y: =Panel_Merknad.ContentY+20
          Children:
            - Label6:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: ="Skriv merknad:"
                  Width: =MerknadInput.Width
            - MerknadInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =CurrentAvtale.Merknad
                  Font: =Font.'Open Sans'
                  Height: =100
                  HintText: ="Merknad skal kun brukes for administrative og praktiske opplysninger ved behov. Ikke skriv personopplysninger eller helseopplysninger her."
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =100
                  Mode: =TextMode.MultiLine
                  Width: =Parent.Width*0.9
            - MangeOrdMerknadAdvarsel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Font: =Font.'Open Sans'
                  Text: ="Du kan ikke skrive mer enn 100 tegn i merknad"
                  Visible: =If(Len(MerknadInput.Text)>99,true,false)
                  Width: =MerknadInput.Width
      - Panel_Enkelttime_New:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Enkelttime_Group
          Properties:
            Buttons: |-
              =Table(
                  {Label: "Med SMS", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true },
                  {Label: "Uten SMS", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true }
              )
              //Hvorfor funker ikke dette under..........
              /*If(
                  IsBlank(SelectedPerson.Value),
                  Table(
                      {Label: "Lagre", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true },
                      {Label: "Avbryt", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true }
                  ),
                      Table(
                      {Label: "Med SMS", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true },
                      {Label: "Uten SMS", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true }
                  )
              )*/
            Description: =""
            DialogWidth: =App.Width / 3
            Fill: =Panel_Enkelttime_New.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =Switch(
                  Self.SelectedButton.Label,
                  "Med SMS",
                  If(
                      IsBlank(SelectedPerson),
                      Notify(
                          "Du kan ikke sende SMS til en ledig time",
                          NotificationType.Error,
                          3000
                      ),
                      If(
                          IsMatch(
                              InputMobilBookTime_1.Text,
                              "^(?:\d{8}|\+\d{1,13})$"
                          ),
                          UpdateContext(
                              {
                                  CurrentAvtale: Patch(
                                      Vaksinerings,
                                      Defaults(Vaksinerings),
                                      {
                                          Konsultasjonsdato: DateTime(
                                              Year(AvtaleDateValue.SelectedDate),
                                              Month(AvtaleDateValue.SelectedDate),
                                              Day(AvtaleDateValue.SelectedDate),
                                              AvtaleHourValue.Selected.Value,
                                              AvtaleMinuteValue.Selected.Value,
                                              00
                                          ),
                                          Timeavtale: DateTime(
                                              Year(AvtaleDateValue.SelectedDate),
                                              Month(AvtaleDateValue.SelectedDate),
                                              Day(AvtaleDateValue.SelectedDate),
                                              AvtaleHourValue.Selected.Value,
                                              AvtaleMinuteValue.Selected.Value,
                                              00
                                          ),
                                          'Hovedtype vaksine': ComboboxCanvasKategoriEnkelTime.Selected.Value,
                                          Account: LookUp(
                                              Accounts,
                                              'Account Name' = TabListAccount.Selected.'Account Name'
                                          ),
                                          Timeboktype: ComboboxTimeboktypeEnkelTime.Selected.Value,
                                          Innbyggerrelatert: Innbyggervaksinering,
                                          Fnr: SelectedPerson.Value,
                                          Name: Text(SelectedPerson.Navn),
                                          'Status for timeavtale': Statusfortimeavtale.'⚪Opptatt',
                                          MobilNummer: InputMobilBookTime_1.Text,
                                          'Email Address': SelectedPerson.Epost,
                                          'SMS bekreftelse sendt til': InputMobilBookTime_1.Text,
                                          'SMS bekreftelse sendt': Now(),
                                          'SMS påmindelse sendt til': Blank(),
                                          'SMS påmindelse sendt': Blank(),
                                          'Booket av ansatt': Now(),
                                          'Booket av innbygger': Blank()
                                      }
                                  )
                              }
                          );
                          Patch(
                              'Sms utsendelser',
                              Defaults('Sms utsendelser'),
                              {
                                  Mobilnummer: CurrentAvtale.MobilNummer,
                                  Timeavtale: CurrentAvtale.Timeavtale,
                                  Navn: CurrentAvtale.Name,
                                  'Sms Type': If(
                                      Innbyggervaksinering,
                                      LookUp(
                                          'Sms typer',
                                          Name = "Timebekreftelse"
                                      ),
                                      LookUp(
                                          'Sms typer',
                                          Name = "Timebekreftelse Ansatt"
                                      )
                                  ),
                                  Vaksinering: CurrentAvtale
                              }
                          );
                          UpdateContext({showEnkelttime: false});
                          Reset(InputMobilBookTime_1),
                          Notify(
                              "Ugyldig mobilnummer - skriv inn et gyldig nummer eller tøm feltet og registrer uten SMS",
                              NotificationType.Error,
                              3000
                          )
                      )
                  ),
                  "Uten SMS",
                  If(
                      IsBlank(SelectedPerson),
                      Patch(
                          Vaksinerings,
                          Defaults(Vaksinerings),
                          {
                              Konsultasjonsdato: DateTime(
                                  Year(AvtaleDateValue.SelectedDate),
                                  Month(AvtaleDateValue.SelectedDate),
                                  Day(AvtaleDateValue.SelectedDate),
                                  AvtaleHourValue.Selected.Value,
                                  AvtaleMinuteValue.Selected.Value,
                                  00
                              ),
                              Timeavtale: DateTime(
                                  Year(AvtaleDateValue.SelectedDate),
                                  Month(AvtaleDateValue.SelectedDate),
                                  Day(AvtaleDateValue.SelectedDate),
                                  AvtaleHourValue.Selected.Value,
                                  AvtaleMinuteValue.Selected.Value,
                                  00
                              ),
                              'Hovedtype vaksine': ComboboxCanvasKategoriEnkelTime.Selected.Value,
                              Account: LookUp(
                                  Accounts,
                                  'Account Name' = TabListAccount.Selected.'Account Name'
                              ),
                              Timeboktype: ComboboxTimeboktypeEnkelTime.Selected.Value,
                              Innbyggerrelatert: Innbyggervaksinering,
                              Fnr: "",
                              Name: "Ledig time",
                              'Status for timeavtale': Statusfortimeavtale.'🆓Ledig',
                              MobilNummer: ""
                          }
                      ),
                      Patch(
                          Vaksinerings,
                          Defaults(Vaksinerings),
                          {
                              Konsultasjonsdato: DateTime(
                                  Year(AvtaleDateValue.SelectedDate),
                                  Month(AvtaleDateValue.SelectedDate),
                                  Day(AvtaleDateValue.SelectedDate),
                                  AvtaleHourValue.Selected.Value,
                                  AvtaleMinuteValue.Selected.Value,
                                  00
                              ),
                              Timeavtale: DateTime(
                                  Year(AvtaleDateValue.SelectedDate),
                                  Month(AvtaleDateValue.SelectedDate),
                                  Day(AvtaleDateValue.SelectedDate),
                                  AvtaleHourValue.Selected.Value,
                                  AvtaleMinuteValue.Selected.Value,
                                  00
                              ),
                              'Hovedtype vaksine': ComboboxCanvasKategoriEnkelTime.Selected.Value,
                              Account: LookUp(
                                  Accounts,
                                  'Account Name' = TabListAccount.Selected.'Account Name'
                              ),
                              Timeboktype: ComboboxTimeboktypeEnkelTime.Selected.Value,
                              Innbyggerrelatert: Innbyggervaksinering,
                              Fnr: SelectedPerson.Value,
                              Name: Text(SelectedPerson.Navn),
                              'Status for timeavtale': Statusfortimeavtale.'⚪Opptatt',
                              MobilNummer: InputMobilBookTime_1.Text,
                              'Email Address': SelectedPerson.Epost,
                              'SMS bekreftelse sendt til': 00000000,
                              'SMS bekreftelse sendt': Now(),
                              'SMS påmindelse sendt til': 00000000,
                              'SMS påmindelse sendt': Now(),
                              'Booket av ansatt': Now(),
                              'Booket av innbygger': Blank()
                          }
                      )
                  );
                  UpdateContext({showEnkelttime: false});
                  Reset(InputMobilBookTime_1);
                  Reset(AvtaleMinuteValue)
              )
            OnCloseSelect: |-
              =UpdateContext({showEnkelttime: false});Reset(AvtaleDateValue);Reset(AvtaleHourValue);Reset(AvtaleMinuteValue)
            OverlayColor: =RGBA(255, 255, 255, 0.19)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Opprett en timeavtale"
            Visible: =showEnkelttime
            Width: =App.Width
      - Container_Enkelttime:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Enkelttime_Group
          Properties:
            DropShadow: =DropShadow.None
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Enkelttime_New.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            Visible: =showEnkelttime
            Width: =Panel_Enkelttime_New.ContentWidth
            X: =Panel_Enkelttime_New.ContentX
            Y: =Panel_Enkelttime_New.ContentY+25
          Children:
            - DateLabel:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Fill: =RGBA(255, 255, 255, 1)
                  Font: =Font.'Open Sans'
                  Height: |+
                    =50

                  PaddingBottom: =4
                  PaddingRight: =4
                  PaddingTop: =4
                  Text: |-
                    ="Det tar opp til et minutt før SMS-bekreftelse sendes ut ved Dropin
                    "
                  Visible: =If(IsBlank(SelectedPerson),false,true)
                  Width: =Parent.Width
            - DateLabelTitle:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =50
                  PaddingTop: =30
                  Text: ="Tidspunkt"
                  Width: =DateLabel.Width
            - Container7:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =Rectangle3.Height
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =5
                  LayoutJustifyContent: =LayoutJustifyContent.Center
                  LayoutMinHeight: =40
                Children:
                  - AvtaleDateValue:
                      Control: Classic/DatePicker@2.6.0
                      Properties:
                        BorderColor: =
                        Color: =RGBA(50, 49, 48, 1)
                        DefaultDate: =Klokka
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        DisplayMode: =Parent.DisplayMode
                        EndYear: =Year(Today())+100
                        Fill: =RGBA(245, 245, 245, 1)
                        Font: =Font.'Segoe UI'
                        IconBackground: =RGBA(0, 120, 212, 1)
                        IconFill: =RGBA(255, 255, 255, 1)
                        IsEditable: =true
                        Language: ="nb-NO"
                        PaddingBottom: =0
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        Reset: =
                        Size: =13
                        StartYear: =2023
                        Tooltip: =
                        Width: =150
                        X: =30
                        Y: =
                  - AvtaleHourValue:
                      Control: Classic/DropDown@2.3.1
                      Properties:
                        BorderColor: =
                        ChevronBackground: =RGBA(245, 245, 245, 1)
                        ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                        ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                        ChevronFill: =RGBA(50, 49, 48, 1)
                        ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                        ChevronHoverFill: =RGBA(50, 49, 48, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        Default: =Text(Hour(Klokka),"00")
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(245, 245, 245, 1)
                        Font: =Font.'Segoe UI'
                        Height: =AvtaleDateValue.Height
                        HoverBorderColor: =RGBA(16, 110, 190, 1)
                        HoverColor: =RGBA(50, 49, 48, 1)
                        HoverFill: =RGBA(245, 245, 245, 1)
                        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                        Items.Value: =Value
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =RGBA(16, 110, 190, 1)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(0, 120, 212, 1)
                        Reset: =
                        SelectionColor: =RGBA(50, 49, 48, 1)
                        SelectionFill: =RGBA(0, 120, 212, 1)
                        Tooltip: =
                        Width: =80
                        X: =AvtaleDateValue.X + AvtaleDateValue.Width + 10
                        Y: =AvtaleDateValue.Y
                  - AvtaleMinuteValue:
                      Control: Classic/DropDown@2.3.1
                      Properties:
                        BorderColor: =
                        ChevronBackground: =RGBA(245, 245, 245, 1)
                        ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                        ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                        ChevronFill: =RGBA(50, 49, 48, 1)
                        ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                        ChevronHoverFill: =RGBA(50, 49, 48, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        Default: =Text(Minute(Klokka),"00")
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(245, 245, 245, 1)
                        Font: =Font.'Segoe UI'
                        Height: =AvtaleHourValue.Height
                        HoverBorderColor: =RGBA(16, 110, 190, 1)
                        HoverColor: =RGBA(50, 49, 48, 1)
                        HoverFill: =RGBA(245, 245, 245, 1)
                        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                        Items.Value: =Value
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =RGBA(16, 110, 190, 1)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(0, 120, 212, 1)
                        Reset: =
                        SelectionColor: =RGBA(50, 49, 48, 1)
                        SelectionFill: =RGBA(0, 120, 212, 1)
                        Tooltip: =
                        Width: =80
                        X: =
                        Y: =AvtaleHourValue.Y
                  - Rectangle3:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(56, 96, 178, 1)
                        Height: =AvtaleDateValue.Height+2
                        Width: =0
            - AccountLabelTitle:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =DateLabelTitle.Height
                  PaddingTop: =30
                  Text: ="Ansvarlig virksomhet"
                  Width: =DateLabel.Width
            - AccountLabel:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, 1)
                  Font: =Font.'Open Sans'
                  Height: |+
                    =30
                  PaddingBottom: =4
                  PaddingRight: =4
                  PaddingTop: =4
                  Text: =TabListAccount.Selected.'Account Name'
                  Width: =DateLabel.Width
            - VaksinekategoriLabelTitle:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =DateLabelTitle.Height
                  PaddingTop: =30
                  Text: ="Hovedtype vaksine"
                  Width: =DateLabel.Width
            - ComboboxCanvasKategoriEnkelTime:
                Control: ComboBox@0.0.51
                Properties:
                  DefaultSelectedItems: =ComboboxKategori.Selected
                  Items: =Choices(Vaksinekategori)
                  Width: |+
                    =200
            - TimeboktypeLabelTitle:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =DateLabelTitle.Height
                  PaddingTop: =30
                  Text: |-
                    ="Timeboktype
                    "
                  Width: =DateLabel.Width
            - ComboboxTimeboktypeEnkelTime:
                Control: ComboBox@0.0.51
                Properties:
                  DefaultSelectedItems: |-
                    ={Value: TimeboktypeChoice.DropIn}
                  Items: =Choices(TimeboktypeChoice)
                  Width: =200
            - Label10:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Navn"
            - Label11:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Lighter
                  Text: =If(IsBlank(SelectedPerson.Value),"Ledig time", SelectedPerson.Navn)
            - Label12:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: =If(Not(IsBlank(SelectedPerson.Value)),"Fnr")
            - Label13:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =SelectedPerson.Value
            - Label12_1:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: =If(Not(IsBlank(SelectedPerson.Value)),"Mobilnummer")
            - InputMobilBookTime_1:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =SelectedPerson.Mobil
                  Font: =Font.'Open Sans'
                  Height: =ComboboxCanvasKategoriEnkelTime.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Visible: =If(IsBlank(SelectedPerson),false,true)
                  Width: =ComboboxCanvasKategoriEnkelTime.Width
      - Panel_JournalList:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Journal_List
          Properties:
            Buttons: |-
              =Table(
                  {Label: "Ok", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_JournalList.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =UpdateContext({showJournalList: false})
            OnCloseSelect: |-
              =UpdateContext({showJournalList: false});
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Journalnotater"
            Visible: =showJournalList
            Width: =App.Width
      - JournalList:
          Control: HtmlViewer@2.1.0
          Group: Panel_Journal_List
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            Height: =Panel_JournalList.ContentHeight+20
            HtmlText: =journalListHTML
            Visible: =Panel_JournalList.Visible
            Width: =Panel_JournalList.ContentWidth-Panel_JournalList.ContentWidth*0.025*2
            X: =Panel_JournalList.ContentX+Panel_JournalList.ContentWidth*0.025
            Y: =Panel_JournalList.ContentY+10
      - Panel_Mobil:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Mobil_Group
          Properties:
            Buttons: "=Table(\r\n    {Label: \"Lagre\", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true },\r\n    {Label: \"Avbryt\", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true}\r\n    \r\n)\r\n"
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Mobil.OverlayColor
            Height: =App.Height
            OnButtonSelect: "=Switch(\n    Self.SelectedButton.Label,\n    \"Lagre\",\n    If(\n        IsMatch(\n            Text(MobilInput.Text),\n            \"^(?:\\d{8}|\\+\\d{1,13})$\"\n        ),\n        If(\n            IsError(\n                Patch(\n                    Vaksinerings,\n                    CurrentAvtale,\n                    {MobilNummer: MobilInput.Text}\n                )\n            ),//On failure\n            Notify(\n                \"Kunne ikke endre mobilnummer på timeavtale: \" & CurrentAvtale.Name,\n                NotificationType.Error\n            ),\n            // On success\n            Notify(\n                \"Lagret mobilnummer på timeavtale: \" & CurrentAvtale.Name,\n                NotificationType.Success,\n                3000\n            )\n        );\n        Reset(MobilInput);\n        UpdateContext({showMobil: false}),\n  \n        Notify(\n            \"Skriv inn et gyldig mobilnummer (8 siffer eller utenlandsk nummer inkludert landkode)\",\n            NotificationType.Error,\n            2000\n        )\n    ),\n    Reset(MobilInput);\n    UpdateContext({showMobil: false})\n)"
            OnCloseSelect: |-
              =UpdateContext({showMobil: false})
            OverlayColor: =RGBA(0, 0, 0, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =CurrentAvtale.Name
            Theme: =AppTheme
            Title: ="Mobilnummer"
            Visible: =showMobil
            Width: =App.Width
      - Container2_1:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Mobil_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Mobil.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =Panel_Mobil.Visible
            Width: =Panel_Mobil.ContentWidth
            X: =Panel_Mobil.ContentX
            Y: =Panel_Mobil.ContentY+20
          Children:
            - MobilLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: |-
                    ="Velg mobilnummer
                    "
                  Width: =MobilInput.Width
            - MobilInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =CurrentAvtale.MobilNummer
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width*0.9
            - Rectangle2:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(56, 96, 178, 1)
                  Height: =MobilLabel.Height*0.5
                  Width: =0
            - MobilLabel_21:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: |+
                    ="SMS-bekreftelse sendt til: " & 
                    If(
                        IsBlank(CurrentAvtale.'SMS bekreftelse sendt til') Or CurrentAvtale.'SMS bekreftelse sendt til' = Text(0),
                        "(ikke sendt)",
                        CurrentAvtale.'SMS bekreftelse sendt til' & " (" & Text(CurrentAvtale.'SMS bekreftelse sendt', "dd.mm.yyyy hh:mm") & ")"
                    )
                  Width: =MobilInput.Width
            - MobilLabel_22:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: |+
                    ="SMS-påminnelse sendt til: " & 
                    If(
                        IsBlank(CurrentAvtale.'SMS påmindelse sendt til') Or CurrentAvtale.'SMS påmindelse sendt til' = Text(0),
                        "(ikke sendt)",
                        CurrentAvtale.'SMS påmindelse sendt til' & " (" & Text(CurrentAvtale.'SMS påmindelse sendt', "dd.mm.yyyy hh:mm") & ")"
                    )
                  Width: =MobilInput.Width
      - Panel_Book:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Book_Group
          Properties:
            Buttons: |
              =Table(
                  {
                      Label: "Med SMS",
                      ButtonType: 'Button.ButtonType'.Primary,
                      Visible: true,
                      //Enabled: Len(InputMobilBookTime.Text) > 5 And IsMatch(InputMobilBookTime.Text,"^\+?[0-9][0-9]{7,14}$")
                      Enabled: true
                  },
                  {
                      Label: "Uten SMS",
                      ButtonType: 'Button.ButtonType'.Standard,
                      Visible: true,
                      //Enabled: Len(InputMobilBookTime.Text) = 0 Or (Len(InputMobilBookTime.Text) > 5 And IsMatch(InputMobilBookTime.Text,"^\+?[0-9][0-9]{7,14}$"))
                      Enabled: true
                  }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Book.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =If(
                  CurrentAvtale.'Modified On' <> LookUp(
                      Vaksinerings,
                      Vaksinering = CurrentAvtale.Vaksinering
                  ).'Modified On',
                  Notify(
                      "Avtalen er oppdatert. Refresh og prøv på nytt!",
                      NotificationType.Error
                  ),
                  Switch(
                      Self.SelectedButton.Label,
                      "Med SMS",
                      If(
                          IsMatch(
                              InputMobilBookTime.Text,
                              "^(?:\d{8}|\+\d{1,13})$"//Enten 8 siffer, eller et plusstegn etterfulgt av opp til 13 siffer
                          ),
                          Patch(
                              'Sms utsendelser',
                              Defaults('Sms utsendelser'),
                              {
                                  Mobilnummer: InputMobilBookTime.Text,
                                  Timeavtale: CurrentAvtale.Timeavtale,
                                  Navn: Text(SelectedPerson.Navn),
                                  'Sms Type': If(
                                      Innbyggervaksinering,
                                      LookUp(
                                          'Sms typer',
                                          Name = "Timebekreftelse"
                                      ),
                                      LookUp(
                                          'Sms typer',
                                          Name = "Timebekreftelse Ansatt"
                                      )
                                  ),
                                  Vaksinering: CurrentAvtale
                              }
                          );
                          Patch(
                              Vaksinerings,
                              CurrentAvtale,
                              {
                                  Fnr: SelectedPerson.Value,
                                  Name: Text(SelectedPerson.Navn),
                                  MobilNummer: InputMobilBookTime.Text,
                                  'Email Address': SelectedPerson.Epost,
                                  'SMS bekreftelse sendt til': InputMobilBookTime.Text,
                                  'SMS bekreftelse sendt': Now(),
                                  'SMS påmindelse sendt til': Blank(),
                                  'SMS påmindelse sendt': Blank(),
                                  'Status for timeavtale': Statusfortimeavtale.'⚪Opptatt',
                                  'Booket av ansatt': Now(),
                                  'Booket av innbygger': Blank(),
                                  Innbyggerrelatert: Innbyggervaksinering
                              }
                          );
                          UpdateContext({showBookTime: false});
                          Reset(InputMobilBookTime),
                          Notify(
                              "Ugyldig mobilnummer - skriv inn et gyldig nummer eller tøm feltet og registrer uten SMS",
                              NotificationType.Error,
                              3000
                          )
                      ),
                      "Uten SMS",
                      Patch(
                          Vaksinerings,
                          CurrentAvtale,
                          {
                              Fnr: SelectedPerson.Value,
                              Name: Text(SelectedPerson.Navn),
                              MobilNummer: InputMobilBookTime.Text,
                              'Email Address': SelectedPerson.Epost,
                              'SMS bekreftelse sendt til': 00000000,
                              'SMS bekreftelse sendt': Now(),
                              'SMS påmindelse sendt til': 00000000,
                              'SMS påmindelse sendt': Now(),
                              'Booket av ansatt': Now(),
                              'Booket av innbygger': Blank(),
                              'Status for timeavtale': Statusfortimeavtale.'⚪Opptatt',
                              Innbyggerrelatert: Innbyggervaksinering
                          }
                      );
                      UpdateContext({showBookTime: false});
                      Reset(InputMobilBookTime)
                  )
              )
            OnCloseSelect: |-
              =UpdateContext({showBookTime: false});
              Reset(InputMobilBookTime)
            OverlayColor: =RGBA(0, 0, 0, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Book time"
            Visible: =showBookTime
            Width: =App.Width
      - Container2_2:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Book_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Book.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =Panel_Book.Visible
            Width: =Panel_Book.ContentWidth
            X: =Panel_Book.ContentX
            Y: =Panel_Book.ContentY+20
          Children:
            - MobilLabel_1:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Person
                    "
                  Width: =InputMobilBookTime.Width
            - MobilLabel_2:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =SelectedPerson.Navn
                  Width: =InputMobilBookTime.Width
            - MobilLabel_3:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Timeavtale"
                  Width: =InputMobilBookTime.Width
            - MobilLabel_4:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =Text(CurrentAvtale.Timeavtale, "dd.mm.yyyy hh:mm")
                  Width: =InputMobilBookTime.Width
            - MobilLabel_6:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Timebok
                    "
                  Width: =InputMobilBookTime.Width
            - MobilLabel_7:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.Timeboktype
                  Width: =InputMobilBookTime.Width
            - MobilLabel_8:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Vaksinekategori
                    "
                  Width: =InputMobilBookTime.Width
            - MobilLabel_9:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.'Hovedtype vaksine'
                  Width: =InputMobilBookTime.Width
            - MobilLabel_5:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Mobilnummer"
                  Width: =InputMobilBookTime.Width
            - InputMobilBookTime:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =SelectedPerson.Mobil
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width*0.9
      - Panel_Avbestill:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Avbestill_Group
          Properties:
            Buttons: |+
              =Table(
                  {Label: "Med SMS", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true },
                  {Label: "Uten SMS", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Avbestill.OverlayColor
            Height: =App.Height
            OnButtonSelect: |+
              =Switch(
                  Self.SelectedButton.Label,
                  "Med SMS",
                  Patch(
                  'Sms utsendelser',
                  Defaults('Sms utsendelser'),
                      {
                          Mobilnummer: CurrentAvtale.MobilNummer,
                          Timeavtale: CurrentAvtale.Timeavtale,
                          Navn: CurrentAvtale.Name,
                          'Sms Type': If(Innbyggervaksinering , LookUp('Sms typer',Name="Avlyst time"), LookUp('Sms typer',Name="Avlyst time Ansatt")),
                          Vaksinering: CurrentAvtale
                      }
                  )
                  //SMSavlysttime.Run(CurrentAvtale.MobilNummer,CurrentAvtale.Vaksinering)
              );
              Patch(
                  Vaksinerings,
                  CurrentAvtale,
                  {
                      Fnr: Blank(),
                      Merknad:Blank(),
                      Name: "Ledig time",
                      MobilNummer:Blank(),
                      'Email Address':Blank(),
                      Contact:Blank(),
                      VaksineInnbygger:Blank(),
                      Triagegruppe:Blank(),
                      triageTid:Blank(),
                      'Status for timeavtale': Statusfortimeavtale.'🆓Ledig',
                      'Egenandel betalt':0,
                      'Betaling mottatt':false,
                      ChatbotEpost:Blank(),
                      ChatbotFulltNavn:Blank(),
                      'Har notat':false,
                      'SMS påmindelse sendt til': Blank(),
                      'SMS påmindelse sendt': Blank(),
                      'SMS bekreftelse sendt til': Blank(),
                      'SMS bekreftelse sendt': Blank(),
                      'SMS OTP Sendt til':Blank(),
                      'SMS OTP Sendt':Blank(),
                      'Booket av ansatt': Blank(),
                      'Booket av innbygger': Blank(),
                      'Manuell CV Tid': Blank(),
                      'Manuell Registrering Tid': Blank(),
                      Innbyggerbooking: false //Midlertidig - MIDLERTIDIG!!!!!!
                  }
              ); 
              RemoveIf('Customer Voice survey responses', Regarding = CurrentAvtale);
              RemoveIf(Notes, Regarding = CurrentAvtale);
              UpdateContext({showAvbestillTime: false})
              //Refresh(Vaksinerings)
            OnCloseSelect: |-
              =UpdateContext({showAvbestillTime: false})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Avbestill time"
            Visible: =showAvbestillTime
            Width: =App.Width
      - Container2_3:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Avbestill_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Avbestill.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =Panel_Avbestill.Visible
            Width: =Panel_Avbestill.ContentWidth
            X: =Panel_Avbestill.ContentX
            Y: =Panel_Avbestill.ContentY+20
          Children:
            - MobilLabel_10:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Person
                    "
                  Width: =MobilInput_2.Width
            - MobilLabel_11:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.Name
                  Width: =MobilInput_2.Width
            - MobilLabel_12:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Timeavtale
                    "
                  Width: =MobilInput_2.Width
            - MobilLabel_13:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =Text(CurrentAvtale.Timeavtale, "dd.mm.yyyy hh:mm")
                  Width: =MobilInput_2.Width
            - MobilLabel_15:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Timebok
                    "
                  Width: =MobilInput_2.Width
            - MobilLabel_16:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.Timeboktype
                  Width: =MobilInput_2.Width
            - MobilLabel_17:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Vaksinekategori
                    "
                  Width: =MobilInput_2.Width
            - MobilLabel_18:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.'Hovedtype vaksine'
                  Width: =MobilInput_2.Width
            - MobilLabel_14:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Mobilnummer
                    "
                  Width: =MobilInput_2.Width
            - MobilInput_2:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.MobilNummer
                  Width: =Parent.Width*0.9
            - MobilLabel_20:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Font: =Font.'Open Sans'
                  Height: =160
                  PaddingTop: =25
                  Text: |-
                    ="Merk:
                    - Timen slettes ikke, men gjøres tilgjengelig for andre.
                    - Venligst velg om du ønsker å sende en SMS til innbygger om at timen er avbestilt eller ikke.
                    - Vær oppmerksom på at dette også sletter eventuelle egenerklæringer og journalnotater knyttet til denne timen. "
                  Width: =MobilInput_2.Width
      - Panel_Book_1:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Vaksine
          Properties:
            Buttons: |+
              =Table(
                  {Label: If(IsBlank(CurrentAvtale.'Sendt til SysVak'),"Registrer","Er sent til sysvak") , ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled: IsBlank(CurrentAvtale.'Sendt til SysVak')},
                  {Label: "Avbryt", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Book_1.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =Switch(
                  Self.SelectedButton.Label,
                  "Registrer",
                    If(
                      IsBlank(VaksinetypeDropdown.Selected) Or IsBlank(BatchLOTInput.Text) Or IsBlank(AarsakDropdown.Selected.Value) Or IsBlank(VaksinasjonsdatoDate.SelectedDate) Or IsBlank(VaksineSattPaaStedetToggle.Checked) Or IsBlank(VaksineatoerInput.Text) Or IsBlank(RekvirentInput.Text) Or IsBlank(AnsvarligVirksomhetDropdown.Selected) Or (IsBlank(EgenandelBetaltToggle.Checked) And Innbyggervaksinering) Or (IsBlank(RegistreringsgrunnlagDropdown.Selected) And Ansattvaksinering),
                      Notify(
                          "Fyll ut alle felter først",
                          NotificationType.Error
                      ),
                      Patch(
                          Vaksinerings,
                          CurrentAvtale,
                          {
                              Vaksinetype: LookUp(
                                  Vaksinetypes,
                                  Vaksinetype = VaksinetypeDropdown.Selected.Vaksinetype
                              ),
                              ErVaksinasjonSattPaStedet: VaksineSattPaaStedetToggle.Checked,
                              'Vaksine satt av': VaksineatoerInput.Text,
                              Batchnummer: BatchLOTInput.Text,
                              RegistrerendeHelseenhet: AnsvarligVirksomhetDropdown.Selected.'Account Name',
                              HendelseAksjon: "Registrering",
                              Account: AnsvarligVirksomhetDropdown.Selected,
                              Rekvirent: RekvirentInput.Text,
                              Merknad: MerknadInputRegistrering.Text,
                              Konsultasjonsdato: VaksinasjonsdatoDate.SelectedDate,
                              'Status for timeavtale': Statusfortimeavtale.'🟢Vaksinert',
                              'Betaling mottatt': EgenandelBetaltToggle.Checked,
                              'Egenandel betalt': VaksinetypeDropdown.Selected.Egenandel,
                              'Årsak til vaksinering': AarsakDropdown.Selected.Value,
                              Registreringsgrunnlag: RegistreringsgrunnlagDropdown.Selected
                          }
                      );
                      UpdateContext(
                          {
                              autofillVaksinetype: VaksinetypeDropdown.Selected,
                              autofillBatch: BatchLOTInput.Text,
                           //   autofillAarsak: AarsakDropdown.Selected.Value,
                              autofillVaksinatoer: VaksineatoerInput.Text,
                              autofillRekvirent: RekvirentInput.Text,
                              autofillAnsvarlig: AnsvarligVirksomhetDropdown.Selected,
                              autofillHovedtypeVaksine: VaksinetypeDropdown.Selected.'Hovedtype vaksine'
                          }
                      );
                   //   Reset(VaksinetypeDropdown);
              //   Reset(BatchInput);
                 Reset(AarsakDropdown);
              Set(resetpanelvaksine, true);Set(resetpanelvaksine, false);
                   //   Refresh(Vaksinerings);
              If(
                          !IsEmpty(Errors(Vaksinerings)),
                          Notify(
                              "Lagring av vaksine feilet",
                              NotificationType.Error
                          ),
                          Notify(
                              "Vaksine er registrert på: " & CurrentAvtale.Name,
                              NotificationType.Success
                          )            
                      );
                      UpdateContext({showVaksinering: false})
                  ),
                  UpdateContext({showVaksinering: false})
              )
            OnCloseSelect: |-
              =UpdateContext({showVaksinering: false})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: |-
              =$"Tidspunkt: {Text(CurrentAvtale.Timeavtale,"dd.mm.yyyy HH.mm")} Type: {CurrentAvtale.'Hovedtype vaksine'}"
            Theme: =AppTheme
            Title: "=$\"Registrer vaksine for: {CurrentAvtale.Name}\" "
            Visible: =showVaksinering
            Width: =App.Width
      - Container2_4:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Vaksine
          Properties:
            DropShadow: =DropShadow.None
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Book_1.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            Visible: =Panel_Book_1.Visible
            Width: =Panel_Book_1.ContentWidth
            X: =Panel_Book_1.ContentX
            Y: =Panel_Book_1.ContentY+20
          Children:
            - Spacer1:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(56, 96, 178, 1)
                  Height: =2
                  Width: =0
            - AdvarseIkkeVerifisertFNR:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Fill: =RGBA(255, 255, 255, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="OBS: Du registrer en timeavtale uten verifisert FNR, sørg for at FNR: "&CurrentAvtale.Fnr&" stemmer."
                  Visible: =If(IsBlank(CurrentAvtale.'Manuell Registrering Tid'), false, true)
                  Width: =VaksinetypeDropdown.Width
            - AdvarselngenCV:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Fill: =RGBA(255, 255, 255, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="OBS: Du registrer en timeavtale uten digital egenerklæring, sørg for at egenerklæring er gjennomgått skriftlig"
                  Visible: =If(CountRows(CurrentAvtale.'Customer Voice survey responses') < 1, true, false)
                  Width: =VaksinetypeDropdown.Width
            - VaksinetypeLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =22
                  Text: |-
                    ="Vaksinetype
                    "
                  Width: =VaksinetypeDropdown.Width
            - VaksinetypeDropdown:
                Control: DropDown@0.0.45
                Properties:
                  DefaultSelectedItems: |+
                    =If(Not(IsBlank(CurrentAvtale.Vaksinetype)),CurrentAvtale.Vaksinetype,If(CurrentAvtale.'Hovedtype vaksine' = autofillHovedtypeVaksine, autofillVaksinetype))
                  Height: =30
                  Items: |-
                    =/*If(
                        Innbyggervaksinering,
                        Filter(
                            Vaksinetypes,
                             'Hovedtype vaksine' = CurrentAvtale.'Hovedtype vaksine' And 'Innbygger relatert' = true And Status = 0
                        ),
                        Filter(
                            Vaksinetypes,
                             'Hovedtype vaksine' = CurrentAvtale.'Hovedtype vaksine' And 'Ansatt relatert' = true And Status = 0
                        )
                    )*/
                    Filter(
                        Filter(Vaksinetypes,'Vaksinetypes (Views)'.'Aktive vaksinetyper'),
                        ThisRecord.'Hovedtype vaksine' = ComboboxKategori.Selected.Value
                    )
                  Width: =Parent.Width*0.95
                Children:
                  - Name2:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Name"
                        FieldName: ="sogv_name"
                        FieldType: ="s"
                        Order: =1
                  - Vaksine_V1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Vaksine_V"
                        FieldName: ="sogv_vaksine_v"
                        FieldType: ="s"
                        Order: =2
                  - Hovedtype vaksine1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Hovedtype vaksine"
                        FieldName: ="sogv_hovedtypevaksine"
                        FieldType: ="l"
                        Order: =3
                  - Created On1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Created On"
                        FieldName: ="createdon"
                        FieldType: ="d"
                        Order: =4
            - BatchLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Batch/LOT-nummer
                    "
                  Width: =VaksinetypeDropdown.Width
            - BatchLOTInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AlignInContainer: =AlignInContainer.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: |+
                    =If(Not(IsBlank(CurrentAvtale.Batchnummer)),CurrentAvtale.Batchnummer,If(CurrentAvtale.'Hovedtype vaksine' = autofillHovedtypeVaksine, autofillBatch))
                  Font: =Font.Arial
                  Height: =30
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  PaddingLeft: =5
                  Reset: =resetpanelvaksine
                  Width: =VaksinetypeDropdown.Width
                  X: =50
            - AarsakLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Årsak til vaksinering
                    "
                  Width: =VaksinetypeDropdown.Width
            - AarsakDropdown:
                Control: DropDown@0.0.45
                Properties:
                  DefaultSelectedItems: |
                    =
                    //[CurrentAvtale.'Årsak til vaksinering']
                    //Blank()
                    If(IsBlank(CurrentAvtale.'Årsak til vaksinering'),Blank(),[CurrentAvtale.'Årsak til vaksinering'])
                  Height: =VaksinetypeDropdown.Height
                  Items: =Choices('Årsak til vaksinering')
                  Width: =VaksinetypeDropdown.Width
                Children:
                  - Value3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Value"
                        FieldName: ="Value"
                        FieldType: ="l"
                        Order: =1
            - VaksinasjonsdatoLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Vaksinasjonsdato
                    "
                  Width: =VaksinetypeDropdown.Width
            - VaksinasjonsdatoDate:
                Control: Classic/DatePicker@2.6.0
                Properties:
                  BorderColor: =RGBA(202, 202, 202, 1)
                  BorderThickness: =0.5
                  DefaultDate: =If(IsBlank(CurrentAvtale.Konsultasjonsdato),Today(),CurrentAvtale.Konsultasjonsdato)
                  Fill: =RGBA(242, 242, 242, 1)
                  Font: =Font.Arial
                  Format: ="dd.mm.yyyy"
                  Height: =VaksinetypeDropdown.Height
                  IconBackground: =RGBA(56, 96, 178, 1)
                  IconFill: =RGBA(255, 255, 255, 1)
                  PaddingLeft: =5
                  PaddingTop: =5
                  Reset: =resetpanelvaksine
                  Size: =13
                  Width: =VaksinetypeDropdown.Width
            - VaksineSattPaaStedetLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Vaksine satt på stedet
                    "
                  Width: =VaksinetypeDropdown.Width
            - VaksineSattPaaStedetToggle:
                Control: Toggle@1.1.5
                Properties:
                  AlignInContainer: =AlignInContainer.Start
                  Checked: =If(IsBlank(CurrentAvtale.ErVaksinasjonSattPaStedet),true,CurrentAvtale.ErVaksinasjonSattPaStedet)
                  Height: =30
                  Label: |-
                    =If(
                        Self.Checked = true,
                        "Ja",
                        "Nei"
                    )
                  LayoutMinWidth: =110
                  Width: =110
                  X: =60
                  Y: =40
            - VaksinatoerLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Vaksinatør
                    "
                  Width: =VaksinetypeDropdown.Width
            - VaksineatoerInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: |+
                    =If(Not(IsBlank(CurrentAvtale.'Vaksine satt av')),CurrentAvtale.'Vaksine satt av', If(CurrentAvtale.'Hovedtype vaksine' = autofillHovedtypeVaksine,autofillVaksinatoer))
                  Font: =Font.Arial
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Reset: =resetpanelvaksine
                  Width: =VaksinetypeDropdown.Width
            - RekvirentLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Rekvirent
                    "
                  Width: =VaksinetypeDropdown.Width
            - RekvirentInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: |-
                    =If(
                        Not(IsBlank(CurrentAvtale.Rekvirent)),
                        CurrentAvtale.Rekvirent,
                        If(
                            CurrentAvtale.'Hovedtype vaksine' = autofillHovedtypeVaksine,
                            autofillRekvirent
                        )
                    )
                  Font: =Font.Arial
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Reset: =resetpanelvaksine
                  Width: =VaksinetypeDropdown.Width
            - AnsvarligVirksomhetLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Ansvarlig virksomhet
                    "
                  Width: =VaksinetypeDropdown.Width
            - AnsvarligVirksomhetDropdown:
                Control: DropDown@0.0.45
                Properties:
                  DefaultSelectedItems: =If(Not(IsBlank(CurrentAvtale.Account)),CurrentAvtale.Account,autofillAnsvarlig)
                  Height: =VaksinetypeDropdown.Height
                  Items: =If (Innbyggervaksinering,Filter(Filter(Accounts,'Accounts (Views)'.'Brukes av PasinfoVaksine ansvarligvirksomhet'), 'Business Type' = 'Business Type (Accounts)'.VaccineCenter),Filter(Filter(Accounts,'Accounts (Views)'.'Brukes av PasinfoVaksine ansvarligvirksomhet'), 'Business Type' = 'Business Type (Accounts)'.Vaccine))
                  Width: =VaksinetypeDropdown.Width
                Children:
                  - Account Name1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Account Name"
                        FieldName: ="name"
                        FieldType: ="s"
                        Order: =1
                  - Main Phone1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Main Phone"
                        FieldName: ="telephone1"
                        FieldType: ="s"
                        Order: =2
                  - 'Address 1: City1':
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: |-
                          ="Address 1: City"
                        FieldName: ="address1_city"
                        FieldType: ="s"
                        Order: =3
                  - Primary Contact1:
                      Control: DropDownDataField@1.5.0
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Primary Contact"
                        FieldName: ="primarycontactid"
                        FieldType: ="E"
                        Order: =4
            - EgenandelBetaltLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: |-
                    ="Egenandel betalt
                    "
                  Visible: =If( Innbyggervaksinering,true, false)
                  Width: =VaksinetypeDropdown.Width
            - EgenandelBetaltToggle:
                Control: Toggle@1.1.5
                Properties:
                  AlignInContainer: =AlignInContainer.Start
                  Checked: =If(IsBlank(CurrentAvtale.'Betaling mottatt'),false,CurrentAvtale.'Betaling mottatt')
                  Height: =30
                  Label: |-
                    =If(
                        Self.Checked = true,
                        "Ja",
                        "Nei"
                    )
                  LabelPosition: ='Toggle.LabelPosition'.After
                  LayoutMinWidth: =110
                  Visible: =If( Innbyggervaksinering,true, false)
                  Width: =110
                  X: =40
                  Y: =40
            - RegistreringsgrunnlagLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: ="Registreringsgrunnlag"
                  Visible: =RegistreringsgrunnlagDropdown.Visible
                  Width: =VaksinetypeDropdown.Width
            - RegistreringsgrunnlagDropdown:
                Control: DropDown@0.0.45
                Properties:
                  DefaultSelectedItems: |
                    =If(IsBlank(CurrentAvtale.Registreringsgrunnlag),If(IsBlank(LookUp('Ansattoversikt basert på lonn',Fnr = CurrentAvtale.Fnr And Lønnsperiode = Lonnsperiode )), LookUp(Registreringsgrunnlag, Name = "4. Annet/ukjent"),LookUp(Registreringsgrunnlag, Name = "3. Ansatt")),CurrentAvtale.Registreringsgrunnlag)
                  Height: =VaksinetypeDropdown.Height
                  Items: =Filter(Registreringsgrunnlag,'Registreringsgrunnlag (Views)'.'Active Registreringsgrunnlag')
                  Visible: =Not(Innbyggervaksinering)
                  Width: =VaksinetypeDropdown.Width
                Children:
                  - Name3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Name"
                        FieldName: ="sogv_name"
                        FieldType: ="s"
                        Order: =1
            - MerknadLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.Arial
                  FontWeight: =FontWeight.Bold
                  Height: =VaksinetypeLabel.Height
                  Text: ="Merknad"
                  Width: =VaksinetypeDropdown.Width
            - MerknadInputRegistrering:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: |-
                    =//CurrentAvtale.Merknad

                    If(Not(IsBlank(CurrentAvtale.Merknad)),CurrentAvtale.Merknad)
                  Font: =Font.Arial
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Reset: =resetpanelvaksine
                  Width: =VaksinetypeDropdown.Width
            - Spacer2:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(56, 96, 178, 1)
                  Height: '=2   '
                  Width: =0
      - Dialog_Fnr:
          Control: CanvasComponent
          ComponentName: Dialog
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Properties:
            BorderRadius: =0
            Buttons: |-
              =Table({Label: "Ok", ButtonType:'Button.ButtonType'.Primary, HasBorder: false })
            Description: ="At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis ?"
            DialogHeight: =400
            DialogWidth: =640
            Fill: =Dialog_Fnr.OverlayColor
            Height: =Parent.Height
            OnButtonSelect: |-
              =UpdateContext({showFnr: false})
            OnCloseSelect: =UpdateContext({showFnr:false})
            OverlayColor: =RGBA(0, 0, 0, 0.4)
            SubTitle: =CurrentAvtale.Name
            Theme: =AppTheme
            Title: ="Fødselsnummer"
            Visible: =showFnr
            Width: =App.Width
      - PersonSoekFnrHolder:
          Control: Text@0.0.51
          Properties:
            Text: |-
              =If(
                  Len(NavnFnrInput.Text) = 11 And 
                  IsNumeric(NavnFnrInput.Text),
                  NavnFnrInput.Text
              )
            Visible: =false
            Y: '=0   '
      - DialogFnrLabel:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Bold
            Height: =70
            Size: =25
            Text: =CurrentAvtale.Fnr
            Visible: =Dialog_Fnr.Visible
            Width: =Dialog_Fnr.ContentWidth
            X: =Dialog_Fnr.ContentX
            Y: =Dialog_Fnr.Height/2
      - Dialog_Avvis:
          Control: CanvasComponent
          ComponentName: Dialog
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Properties:
            BorderRadius: =0
            Buttons: |-
              =Table(
                  {Label: "Lagre", ButtonType:'Button.ButtonType'.Primary, HasBorder: false },
                  {Label: "Avbryt", ButtonType:'Button.ButtonType'.Standard, HasBorder: false }
              )
            Description: ="At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis ?"
            DialogHeight: =400
            DialogWidth: =640
            Fill: =Dialog_Avvis.OverlayColor
            Height: =Parent.Height
            OnButtonSelect: |-
              =Switch(
                  Self.SelectedButton.Label,
                  "Lagre",
                  Patch(
                      Vaksinerings,
                      CurrentAvtale,
                      {
                          'Status for timeavtale': Statusfortimeavtale.'🔴Avvist'
                      }
                  );
                  UpdateContext({showAvvis: false});
                 // Refresh(Vaksinerings);
                  If(
                      !IsEmpty(Errors(Vaksinerings)),
                      Notify(
                          "Timeavtale avvist: "&CurrentAvtale.Name,
                          NotificationType.Error
                      ),
                      Notify(
                          "Timeavtale avvist: "&CurrentAvtale.Name,
                          NotificationType.Success,
                          3000
                      )
                  ),
                  UpdateContext({showAvvis: false});
              )
            OnCloseSelect: =UpdateContext({showAvvis:false})
            OverlayColor: =RGBA(0, 0, 0, 0.4)
            SubTitle: ="Er du sikker du vil avvise denne avtalen?"
            Theme: =AppTheme
            Title: =$"{CurrentAvtale.Name} {Text(CurrentAvtale.Timeavtale,"dd.mm.yyyy hh:mm")} "
            Visible: =showAvvis
            Width: =App.Width
      - Panel_Status:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Status_Group
          Properties:
            Buttons: |-
              =Table({Label: "Avbryt", ButtonType:'Button.ButtonType'.Standard , Visible:true, Enabled:true } ,{Label: "Lagre", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true })
            Description: =""
            DialogWidth: =App.Width / 3
            Fill: =Panel_Status.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =Switch(
                  Self.SelectedButton.Label,
                  "Lagre",
                  Patch(
                      Vaksinerings,
                      CurrentAvtale,
                      {
                          'Status for timeavtale': ComboboxStatusforavtale.Selected.Value
                      }
                  );
                  Reset(ComboboxStatusforavtale);
                  UpdateContext({showStatus: false});
                  //Refresh(Vaksinerings);
                  If(
                      !IsEmpty(Errors(Vaksinerings)),
                      Notify(
                          "Lagring av status feilet",
                          NotificationType.Error
                      ),
                      Notify(
                          "Status registrert: " & CurrentAvtale.Name,
                          NotificationType.Success,
                          3000
                      )
                  ),
                  UpdateContext({showStatus: false});
              )
            OnCloseSelect: |-
              =UpdateContext({showStatus: false})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Timestatus"
            Visible: =showStatus
            Width: =App.Width
      - Container2_5:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Status_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Status.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =Panel_Status.Visible
            Width: =Panel_Status.ContentWidth
            X: =Panel_Status.ContentX
            Y: =Panel_Status.ContentY+20
          Children:
            - ComboboxStatusforavtale:
                Control: ComboBox@0.0.51
                Properties:
                  DefaultSelectedItems: |-
                    ={Value: CurrentAvtale.'Status for timeavtale'}
                  Items: |-
                    =Filter(
                        Choices(Statusfortimeavtale),
                        Value = Statusfortimeavtale.' ℹ️ Duplikat/Feilregistrering' Or Value = Statusfortimeavtale.'⏰Ikke møtt' Or Value = Statusfortimeavtale.'🔴Avvist' Or Value = Statusfortimeavtale.'🟡Møtt opp'
                    )
                    //Choices(Statusfortimeavtale)
      - Panel_IkkeFnr:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_IkkeFnr_Group
          Properties:
            Buttons: |-
              =Table(
                  {
                      Label: "Avbryt",
                      ButtonType: 'Button.ButtonType'.Standard,
                      Visible: true,
                      Enabled: true
                  },
                  {
                      Label: "Lagre",
                      ButtonType: 'Button.ButtonType'.Primary,
                      Visible: true,
                      Enabled: Len(TextInputFornavnIkkeFnr.Text) > 2 And Len(TextInputEtterNavnIkkeFnr.Text) > 2 And Not(IsBlank(DatePickerDobIkkeFnr.SelectedDate)) And ((Len(TextInputMobilIkkeFnr.Text) > 5 And IsMatch(
                          TextInputMobilIkkeFnr.Text,
                          "^\+?[0-9][0-9]{7,14}$"
                      )) Or IsBlank(TextInputMobilIkkeFnr.Text)) And ((Len(TextInputEpostIkkeFnr.Text) > 5 And IsMatch(
                          TextInputEpostIkkeFnr.Text,
                          "^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$"
                      )) Or IsBlank(TextInputEpostIkkeFnr.Text))
                  }
              )
            Description: =""
            DialogWidth: =App.Width / 3
            Fill: =Panel_IkkeFnr.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =Switch(
                  Self.SelectedButton.Label,
                  "Lagre",
                  UpdateContext({PersonSoekResponse: Blank()});
                  //Tømmer den først så forrige data blir borte fra tabellen, dernest hentes nye personer
                  UpdateContext({PersonSoekResponse: [Text(DateTimeValue(DatePickerDobIkkeFnr.SelectedDate),"ddmmyy")]});
                  UpdateContext({showikkeFnr: false}),
                  UpdateContext({showikkeFnr: false});
              )
            OnCloseSelect: |-
              =UpdateContext({showikkeFnr: false})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: ="Person uten norsk fødsels- eller D-nummer"
            Theme: =AppTheme
            Title: ="Registering"
            Visible: =showikkeFnr
            Width: =App.Width
      - Container_ikkeFnr:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_IkkeFnr_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_IkkeFnr.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            PaddingLeft: =10
            PaddingRight: =10
            Visible: =Panel_IkkeFnr.Visible
            Width: =Panel_IkkeFnr.ContentWidth
            X: =Panel_IkkeFnr.ContentX
            Y: =Panel_IkkeFnr.ContentY+20
          Children:
            - Label2_2:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Etternavn (må fylles ut):"
            - TextInputEtterNavnIkkeFnr:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Clear: =true
                  Default: =""
                  Font: =Font.'Open Sans'
                  HintText: =
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
            - Label2:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Fornavn/mellomnavn (må fylles ut):"
            - TextInputFornavnIkkeFnr:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Clear: =true
                  Default: =""
                  Font: =Font.'Open Sans'
                  HintText: =
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
            - Label4:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Fødselsdato (må fylles ut)"
            - DatePickerDobIkkeFnr:
                Control: Classic/DatePicker@2.6.0
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  DefaultDate: =
                  EndYear: =Year(Today())
                  Font: =Font.'Open Sans'
                  Format: ="dd.mm.yyyy"
                  IconBackground: =RGBA(56, 96, 178, 1)
                  IconFill: =RGBA(255, 255, 255, 1)
                  InputTextPlaceholder: =
                  StartOfWeek: =StartOfWeek.Monday
                  StartYear: =1900
            - Label7:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: ="Mobil:"
            - TextInputMobilIkkeFnr:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Clear: =true
                  Default: =
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
            - LabelFeilMobil:
                Control: Label@2.5.1
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Font: =Font.'Open Sans'
                  Size: =8
                  Text: ="Oppgi et gyldig mobilnummer!"
                  Visible: =Len(TextInputMobilIkkeFnr.Text) > 5 And Not(IsMatch(TextInputMobilIkkeFnr.Text,"^\+?[0-9][0-9]{7,14}$"))
            - Label8:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: ="Epost:"
            - TextInputEpostIkkeFnr:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Clear: =true
                  Default: =""
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =UpdateContext({EmailOK: IsMatch(TextInputEpostIkkeFnr.Text,"^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$")})
            - LabelFeilEmail:
                Control: Label@2.5.1
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Font: =Font.'Open Sans'
                  Size: =8
                  Text: ="Oppgi en gyldig e-postadresse!"
                  Visible: =Len(TextInputEpostIkkeFnr.Text) > 5 And Not(IsMatch(TextInputEpostIkkeFnr.Text,"^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$"))
      - Panel_Endre:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Endre_Group
          Properties:
            Buttons: |-
              =Table(
                   {
                      Label: "Avbryt",
                      ButtonType: 'Button.ButtonType'.Standard,
                      Visible: true,
                      Enabled: true
                  },
                  {
                      Label: "Med SMS",
                      ButtonType: 'Button.ButtonType'.Primary,
                      Visible: true,
                      Enabled: true
                  },
                  {
                      Label: "Uten SMS",
                      ButtonType: 'Button.ButtonType'.Standard,
                      Visible: true,
                      Enabled: true
                  }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Endre.OverlayColor
            Height: =App.Height
            OnButtonSelect: "=If(\n    Self.SelectedButton.Label = \"Avbryt\",\n    UpdateContext({showEndre: false}),\n    //Lagrer fra timeavtale\n    UpdateContext({LastTimeavtale: CurrentAvtale.Timeavtale});\n    If(\n        Not(ToggleEndreFlytte.Checked),\n        If(\n            Not(IsBlankOrError(SelectedTilAvtale)),\n            UpdateContext(\n                {\n                    NewTimeavtale: SelectedTilAvtale.Timeavtale\n                }\n            );\n            // Oppdatere til avtalen\n            Patch(\n                Vaksinerings,\n                SelectedTilAvtale,\n                {Timeavtale: LastTimeavtale}\n            );\n            \n            // Oppdatere fra avtalen    \n            Patch(\n                Vaksinerings,\n                CurrentAvtale,\n                {Timeavtale: NewTimeavtale}\n            );\n            UpdateContext({showEndre: false});,\n            Notify(\"Velg en avtale først\", NotificationType.Error,2000)\n        ),\n        // Bare endre avtalen        \n        Patch(\n            Vaksinerings,\n            CurrentAvtale,\n            {\n                Timeavtale:  DateTime(Year(AvtaleDateValue_1.SelectedDate),Month(AvtaleDateValue_1.SelectedDate),Day(AvtaleDateValue_1.SelectedDate),AvtaleHourValue_1.Selected.Value ,AvtaleMinuteValue_1.Selected.Value,00)\n            }\n        );\n        UpdateContext({showEndre: false});\n    );\n    If(\n        Self.SelectedButton.Label = \"Med SMS\",\n        Patch(\n            'Sms utsendelser',\n            Defaults('Sms utsendelser'),\n            {\n                Mobilnummer: CurrentAvtale.MobilNummer,\n                Timeavtale: LastTimeavtale,\n                Navn: CurrentAvtale.Name,\n                'Sms Type': If(\n                    Innbyggervaksinering,\n                    LookUp(\n                        'Sms typer',\n                        Name = \"Endret time\"\n                    ),\n                    LookUp(\n                        'Sms typer',\n                        Name = \"Endret time Ansatt\"\n                    )\n                ),\n                Vaksinering: CurrentAvtale\n            }\n        );\n    )\n)"
            OnCloseSelect: |-
              =UpdateContext({showEndre: false})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: |-
              =$"Timeavtale: {Text(CurrentAvtale.Timeavtale, "dd.mm.yyyy hh:mm")}"
            Theme: =AppTheme
            Title: =$"Endre time for {CurrentAvtale.Name}"
            Visible: =showEndre
            Width: =App.Width
      - ContainerEndre:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Endre_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Endre.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =showEndre
            Width: =Panel_Endre.ContentWidth
            X: =Panel_Endre.ContentX
            Y: =Panel_Endre.ContentY+20
          Children:
            - ToggleEndreFlytte:
                Control: Toggle@1.1.5
                Properties:
                  AlignInContainer: =AlignInContainer.Center
                  Label: =If(Self.Checked,"Endre tidspunkt for timeavtalen","Flytte avtalen til en annen ledig time i samme timebok")
                  LayoutMinWidth: =110
                  OnCheck: ="Flytte"
                  OnUncheck: ="Flytte"
                  Width: =450
            - Container11:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  LayoutDirection: =LayoutDirection.Vertical
                  Visible: =Not(ToggleEndreFlytte.Checked)
                Children:
                  - ContainerFlytt:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        FillPortions: =0
                        Height: =30
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                      Children:
                        - DropdownFraDatoBytte:
                            Control: Classic/DatePicker@2.6.0
                            Properties:
                              BorderColor: =RGBA(166, 166, 166, 1)
                              Color: =ColorValue(AppTheme.palette.themeDark)
                              DisabledBorderColor: =RGBA(0, 0, 0, 0)
                              DisabledFill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Segoe UI'
                              Format: ="dd.mm.yyyy"
                              Height: =30
                              IconBackground: =RGBA(0, 120, 212, 1)
                              IconFill: =RGBA(255, 255, 255, 1)
                              PaddingLeft: =0
                              PaddingRight: =0
                              PaddingTop: =5
                              Size: =10
                              StartOfWeek: =StartOfWeek.Monday
                              Width: =200
                        - CheckboxCanvasEndreEtter12:
                            Control: CheckBox@0.0.30
                            Properties:
                              Height: =30
                              Label: ="avtaler etter 12:00"
                  - EndreTimeDetailList:
                      Control: CodeComponent
                      ComponentName: cat_PowerCAT.FluentDetailsList
                      Properties:
                        Items: |-
                          =AddColumns(
                              Filter(
                                  SortByColumns(
                                      Vaksinerings,
                                      "sogv_timeavtale",
                                      SortOrder.Ascending
                                  ),
                                  Timeavtale >= If(
                                      CheckboxCanvasEndreEtter12.Checked,
                                      DateAdd(
                                          DropdownFraDatoBytte.SelectedDate,
                                          12,
                                          TimeUnit.Hours
                                      ),
                                      DropdownFraDatoBytte.SelectedDate
                                  ) And ThisRecord.'Hovedtype vaksine' = CurrentAvtale.'Hovedtype vaksine' And ThisRecord.Timeboktype = CurrentAvtale.Timeboktype And ThisRecord.Account.Account = GUID(CurrentAvtale.Account.Account) And ThisRecord.'Status for timeavtale' = Statusfortimeavtale.'🆓Ledig' And ThisRecord.Status = 0
                              ),
                              Tidspunkt,
                              Text(
                                  ThisRecord.Timeavtale,
                                  "dd.mm.yyyy hh:mm"
                              ),
                              RecordKey,
                              ThisRecord.Vaksinering
                          )
                        LargeDatasetPaging: =true
                        OnChange: |
                          =UpdateContext(
                              {
                                  SelectedTilAvtale: LookUp(
                                      Vaksinerings,
                                      Vaksinering = GUID(EndreTimeDetailList.Selected.RecordKey)
                                  )
                              }
                          );
                        RaiseOnRowSelectionChangeEvent: =true
                        columns_Items: |+
                          =Table(
                              {
                                  ColName: "Tidspunkt",
                                  ColDisplayName: "Tidspunkt",
                                  ColWidth: 200,
                                  ColSortable: true,
                                  ColIsBold: true,
                                  ColResizable: true
                              },
                              {
                                  ColName: "sogv_hovedtypevaksine",
                                  ColDisplayName: "Hovedtype",
                                  ColWidth: 200,
                                  ColSortable: true,
                                  ColIsBold: true,
                                  ColResizable: true
                              },
                               {
                                  ColName: "sogv_vaksineringstatus",
                                  ColDisplayName: "Time status",
                                  ColWidth: 200,
                                  ColSortable: true,
                                  ColIsBold: true,
                                  ColResizable: true
                              },
                               {
                                  ColName: "sogv_Account",
                                  ColDisplayName: "",
                                  ColWidth: 200,
                                  ColSortable: true,
                                  ColIsBold: true,
                                  ColResizable: true
                              }
                          )


            - ContainerEndreIkkeFlytte:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =Container11.Height
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =5
                  LayoutJustifyContent: =LayoutJustifyContent.Center
                  LayoutMinHeight: =30
                  Visible: =ToggleEndreFlytte.Checked
                Children:
                  - AvtaleDateValue_1:
                      Control: Classic/DatePicker@2.6.0
                      Properties:
                        BorderColor: =
                        Color: =RGBA(50, 49, 48, 1)
                        DefaultDate: =Klokka
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        DisplayMode: =Parent.DisplayMode
                        EndYear: =Year(Today())+100
                        Fill: =RGBA(245, 245, 245, 1)
                        Font: =Font.'Segoe UI'
                        Height: =30
                        IconBackground: =RGBA(0, 120, 212, 1)
                        IconFill: =RGBA(255, 255, 255, 1)
                        IsEditable: =true
                        Language: ="nb-NO"
                        PaddingBottom: =0
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        Reset: =
                        Size: =10
                        StartYear: =2023
                        Tooltip: =
                        Width: =150
                        X: =30
                        Y: =
                  - AvtaleHourValue_1:
                      Control: Classic/DropDown@2.3.1
                      Properties:
                        BorderColor: =
                        ChevronBackground: =RGBA(245, 245, 245, 1)
                        ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                        ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                        ChevronFill: =RGBA(50, 49, 48, 1)
                        ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                        ChevronHoverFill: =RGBA(50, 49, 48, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        Default: =Text(Hour(Klokka),"00")
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(245, 245, 245, 1)
                        Font: =Font.'Segoe UI'
                        Height: =30
                        HoverBorderColor: =RGBA(16, 110, 190, 1)
                        HoverColor: =RGBA(50, 49, 48, 1)
                        HoverFill: =RGBA(245, 245, 245, 1)
                        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                        Items.Value: =Value
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =RGBA(16, 110, 190, 1)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(0, 120, 212, 1)
                        Reset: =
                        SelectionColor: =RGBA(50, 49, 48, 1)
                        SelectionFill: =RGBA(0, 120, 212, 1)
                        Size: =10
                        Tooltip: =
                        Width: =80
                        X: =AvtaleDateValue_1.X + AvtaleDateValue_1.Width + 10
                        Y: =AvtaleDateValue_1.Y
                  - AvtaleMinuteValue_1:
                      Control: Classic/DropDown@2.3.1
                      Properties:
                        BorderColor: =
                        ChevronBackground: =RGBA(245, 245, 245, 1)
                        ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                        ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                        ChevronFill: =RGBA(50, 49, 48, 1)
                        ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                        ChevronHoverFill: =RGBA(50, 49, 48, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        Default: =Text(Minute(Klokka),"00")
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(245, 245, 245, 1)
                        Font: =Font.'Segoe UI'
                        Height: =30
                        HoverBorderColor: =RGBA(16, 110, 190, 1)
                        HoverColor: =RGBA(50, 49, 48, 1)
                        HoverFill: =RGBA(245, 245, 245, 1)
                        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                        Items.Value: =Value
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =RGBA(16, 110, 190, 1)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(0, 120, 212, 1)
                        Reset: =
                        SelectionColor: =RGBA(50, 49, 48, 1)
                        SelectionFill: =RGBA(0, 120, 212, 1)
                        Size: =10
                        Tooltip: =
                        Width: =80
                        X: =
                        Y: =AvtaleHourValue_1.Y
      - Icon_hjelp:
          Control: CodeComponent
          ComponentName: cat_PowerCAT.Icon
          Properties:
            AccessibilityLabel: ="Hjelp for Pasinfo Vaksine"
            FontColor: ="White"
            Height: =32
            IconName: ="Help"
            IconType: ='PowerCAT.Icon.IconType'.ActionButton
            OnChange: |-
              =UpdateContext({showHjelp : true})
            Tooltip: ="Hjelp for Pasinfo Vaksine"
            Width: =30
            X: =Header_2.Y + Header_2.ContentWidth - 100
            Y: =8
      - Panel_Hjelp:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Group_Hjelp
          Properties:
            Buttons: |-
              =Table({Label: "Ok", ButtonType:'Button.ButtonType'.Primary, Visible:true, Enabled:true })
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Hjelp.OverlayColor
            Height: =App.Height
            OnButtonSelect: =UpdateContext({showHjelp:false})
            OnCloseSelect: =UpdateContext({showHjelp:false})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Hjelp for Pasinfo Vaksine"
            Visible: =showHjelp
            Width: =App.Width
      - Container_Hjelp:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Group_Hjelp
          Properties:
            Height: =Panel_Hjelp.ContentHeight
            LayoutDirection: =LayoutDirection.Vertical
            Visible: =Panel_Hjelp.Visible
            Width: =Panel_Hjelp.ContentWidth
            X: =Panel_Hjelp.ContentX
            Y: =Panel_Hjelp.ContentY + 40
          Children:
            - responsiveIframePCFControl1:
                Control: CodeComponent
                ComponentName: nd_NghiemDoan.responsiveIframePCFControl
                Properties:
                  source: ="https://heloslokommuneno.sharepoint.com/"
      - CheckboxCanvas1:
          Control: CheckBox@0.0.30
          Properties:
            AccessibleLabel: ="Etter 12:00"
            Label: =""
            Width: =40
            X: =Container5.X +135
            Y: =Container5.Y + 55
      - Panel_InnbyggerbookingInv:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_InnbyggerbookingInv_Group
          Properties:
            Buttons: |-
              =Table(
                  {
                      Label: "Send",
                      ButtonType: 'Button.ButtonType'.Primary,
                      Visible: true,
                      Enabled: true
                  }
              )
            Description: =""
            DialogWidth: =App.Width / 3
            Fill: =Panel_InnbyggerbookingInv.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =If(
                  IsMatch(
                      MobilInnbyggerbookingInv.Text,
                      "^\+?[0-9]{7,15}$"
                  ),
                  If(
                      IsError(
                          Patch(
                              'Sms utsendelser',
                              Defaults('Sms utsendelser'),
                              {
                                  Mobilnummer: MobilInnbyggerbookingInv.Text,
                                  'Sms Type': LookUp(
                                      'Sms typer',
                                      Name = "Invitasjon innbyggerbooking"
                                  )
                              }
                          )
                      ),
                    // On failure
                      Notify(
                          "Lagring feilet",
                          NotificationType.Error
                      ),
                  // On success
                      Notify(
                          "Sendte invitasjon for innbyggerbooking til: " & MobilInnbyggerbookingInv.Text,
                          NotificationType.Success,
                          2000
                      );
                      Reset(MobilInnbyggerbookingInv);
                      UpdateContext({showInnbyggerbookingInv: false})
                  ),
                  Notify(
                      "Skriv inn et gyldig mobilnummer (8 siffer eller utenlandsk nummer inkludert landkode)",
                      NotificationType.Error,
                      2000
                  )
              )
            OnCloseSelect: |-
              =UpdateContext({showInnbyggerbookingInv: false})
            OverlayColor: =RGBA(255, 255, 255, 0.4)
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: ="Inviter innbyggere til å booke time selv ved å sende dem lenke til chatbot for innbyggerbooking"
            Theme: =AppTheme
            Title: ="Invitasjon innbyggerbooking"
            Visible: =showInnbyggerbookingInv
            Width: =App.Width
      - Container_ikkeFnr_1:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_InnbyggerbookingInv_Group
          Properties:
            Height: =Panel_InnbyggerbookingInv.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            PaddingLeft: =10
            PaddingRight: =10
            Visible: =Panel_InnbyggerbookingInv.Visible
            Width: =Panel_InnbyggerbookingInv.ContentWidth
            X: =Panel_InnbyggerbookingInv.ContentX
            Y: =Panel_InnbyggerbookingInv.ContentY+20
          Children:
            - Label2_1:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Mobilnummer"
            - MobilInnbyggerbookingInv:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Clear: =true
                  Default: =""
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
      - Klokke:
          Control: Timer@2.1.0
          Properties:
            AutoStart: =true
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =ColorFade(Self.BorderColor, 70%)
            DisabledColor: =ColorFade(Self.Fill, 90%)
            DisabledFill: =ColorFade(Self.Fill, 70%)
            DisplayMode: =DisplayMode.Disabled
            Duration: =10000
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnTimerEnd: =If(Not(showEnkelttime) And Not(showEndre),UpdateContext({ Klokka:Now() }))
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Repeat: =true
            Visible: =false
            X: =236
      - Panel_Book_Reserve:
          Control: CanvasComponent
          ComponentName: Panel
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Group: Panel_Book_Reserve_Group
          Properties:
            Buttons: |
              =Table(
                  {
                      Label: "Med SMS",
                      ButtonType: 'Button.ButtonType'.Primary,
                      Visible: true,
                      //Enabled: Len(InputMobilBookTime.Text) > 5 And IsMatch(InputMobilBookTime.Text,"^\+?[0-9][0-9]{7,14}$")
                      Enabled: true
                  },
                  {
                      Label: "Uten SMS",
                      ButtonType: 'Button.ButtonType'.Standard,
                      Visible: true,
                      //Enabled: Len(InputMobilBookTime.Text) > 5 And IsMatch(InputMobilBookTime.Text,"^\+?[0-9][0-9]{7,14}$")
                      Enabled: true
                  }
              )
            Description: =""
            DialogWidth: =App.Width / 2
            Fill: =Panel_Book_Reserve.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
              =If(
                  CurrentAvtale.'Modified On' <> LookUp(
                      Vaksinerings,
                      Vaksinering = CurrentAvtale.Vaksinering
                  ).'Modified On',
                  Notify(
                      "Avtalen er oppdatert. Refresh og prøv på nytt!",
                      NotificationType.Error
                  ),
                  If(
                      IsMatch(
                          InputMobilBookTimeReserve.Text,
                          "^(?:\d{8}|\+\d{1,13})$"
                      ) Or IsBlank(InputMobilBookTimeReserve.Text),
                      If(
                          Len(FornavnInput.Text) > 1 And Len(EtternavnInput.Text) > 1,
                          If(
                              IsMatch(
                                  FnrInput.Text,
                                  "^\d{11}$"
                              ),
                              Switch(
                                  Self.SelectedButton.Label,
                                  "Med SMS",
                                  If(
                                      IsMatch(
                                          InputMobilBookTimeReserve.Text,
                                          "^(?:\d{8}|\+\d{1,13})$"
                                      ),
                                      Patch(
                                          'Sms utsendelser',
                                          Defaults('Sms utsendelser'),
                                          {
                                              Mobilnummer: InputMobilBookTimeReserve.Text,
                                              Timeavtale: CurrentAvtale.Timeavtale,
                                              Navn: Upper(EtternavnInput.Text & " " & FornavnInput.Text),
                                              'Sms Type': If(
                                                  Innbyggervaksinering,
                                                  LookUp(
                                                      'Sms typer',
                                                      Name = "Timebekreftelse"
                                                  ),
                                                  LookUp(
                                                      'Sms typer',
                                                      Name = "Timebekreftelse Ansatt"
                                                  )
                                              ),
                                              Vaksinering: CurrentAvtale
                                          }
                                      );
                                      Patch(
                                      Vaksinerings,
                                      CurrentAvtale,
                                          {
                                              Fnr: FnrInput.Text,
                                              Name: Upper(EtternavnInput.Text & " " & FornavnInput.Text),
                                              MobilNummer: InputMobilBookTimeReserve.Text,
                                              'Email Address': Blank(),
                                              'SMS bekreftelse sendt til': InputMobilBookTimeReserve.Text,
                                              'SMS bekreftelse sendt': Now(),
                                              'Booket av ansatt': Now(),
                                              'Booket av innbygger': Blank(),
                                              'Status for timeavtale': Statusfortimeavtale.'⚪Opptatt',
                                              Innbyggerrelatert: Innbyggervaksinering,
                                              'Manuell Registrering Tid': Now()
                                          }
                                      ),
                                      Notify(
                                          "Ugyldig mobilnummer",
                                          NotificationType.Error,
                                          3000
                                      )
                                  ),
                                  "Uten SMS",
                                  Patch(
                                      Vaksinerings,
                                      CurrentAvtale,
                                      {
                                          Fnr: FnrInput.Text,
                                          Name: Upper(EtternavnInput.Text & " " & FornavnInput.Text),
                                          MobilNummer: InputMobilBookTimeReserve.Text,
                                          'Email Address': Blank(),
                                          'SMS bekreftelse sendt til': 00000000,
                                          'SMS bekreftelse sendt': Now(),
                                          'SMS påmindelse sendt til': 00000000,
                                          'SMS påmindelse sendt': Now(),
                                          'Booket av ansatt': Now(),
                                          'Booket av innbygger': Blank(),
                                          'Status for timeavtale': Statusfortimeavtale.'⚪Opptatt',
                                          Innbyggerrelatert: Innbyggervaksinering,
                                          'Manuell Registrering Tid': Now()
                                      }
                                  )
                              );
                              UpdateContext({showBookTimeReserve: false});
                              Reset(InputMobilBookTimeReserve);
                              Reset(FornavnInput);
                              Reset(FnrInput);
                              Reset(EtternavnInput),
                              Notify(
                                  "Ugyldig fødselsnummer",
                                  NotificationType.Error,
                                  3000
                              )
                          ),
                          Notify(
                              "Ugyldig navn",
                              NotificationType.Error,
                              3000
                          )
                      ),
                      Notify(
                          "Ugyldig mobilnummer - skriv inn et gyldig nummer eller tøm feltet og registrer uten mobilnummer",
                          NotificationType.Error,
                          3000
                      )
                  )
              )
            OnCloseSelect: |-
              =UpdateContext({showBookTimeReserve: false});
              Reset(InputMobilBookTimeReserve);
              Reset(FornavnInput);
              Reset(FnrInput);
              Reset(EtternavnInput)
            OverlayColor: =If(manuellRegistrering,RGBA(125, 0, 0, 0.4))
            PanelPosition: ="Right"
            RoundedButtons: =true
            Subtitle: =""
            Theme: =AppTheme
            Title: ="Book time (Reserveløsning)"
            Visible: =showBookTimeReserve
            Width: =App.Width
      - Container2_6:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Panel_Book_Reserve_Group
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Panel_Book_Reserve.ContentHeight
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            Visible: =Panel_Book_Reserve.Visible
            Width: =Panel_Book_Reserve.ContentWidth
            X: =Panel_Book_Reserve.ContentX
            Y: =Panel_Book_Reserve.ContentY+20
          Children:
            - FødselsdatoLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 0, 0, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =80
                  Text: |-
                    ="Kun registrer timeavtaler her dersom folkeregisteret er nede.

                    Vær helt sikker på at du skriver inn riktig FNR, navnet er ikke like kritisk, men minst ett fornavn og etternavn må med."
                  Width: =InputMobilBookTimeReserve.Width
            - FnrLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Fødsels- eller D-nummer
                    "
                  Width: =InputMobilBookTimeReserve.Width
            - FnrInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =SelectedPerson.Mobil
                  Font: =Font.'Open Sans'
                  HintText: ="11 siffer"
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width*0.9
            - FornavnLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Fornavn/Mellomnavn
                    "
                  Width: =InputMobilBookTimeReserve.Width
            - FornavnInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =SelectedPerson.Mobil
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width*0.9
            - EtternavnLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Etternavn
                    "
                  Width: =InputMobilBookTimeReserve.Width
            - EtternavnInput:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =SelectedPerson.Mobil
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width*0.9
            - TimeavtaleLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Timeavtale"
                  Width: =InputMobilBookTimeReserve.Width
            - TimeavtaleVerdiLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =Text(CurrentAvtale.Timeavtale, "dd.mm.yyyy hh:mm")
                  Width: =InputMobilBookTimeReserve.Width
            - TimebokLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Timebok
                    "
                  Width: =InputMobilBookTimeReserve.Width
            - TimebokVerdiLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.Timeboktype
                  Width: =InputMobilBookTimeReserve.Width
            - VaksinekategoriLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: |-
                    ="Vaksinekategori
                    "
                  Width: =InputMobilBookTimeReserve.Width
            - VaksinekategoriVerdiLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Text: =CurrentAvtale.'Hovedtype vaksine'
                  Width: =InputMobilBookTimeReserve.Width
            - MobilNummerLabel:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Text: ="Mobilnummer"
                  Width: =InputMobilBookTimeReserve.Width
            - InputMobilBookTimeReserve:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Default: =SelectedPerson.Mobil
                  Font: =Font.'Open Sans'
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width*0.9
      - Dialog_Bekreft_Manuell_CV:
          Control: CanvasComponent
          ComponentName: Dialog
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Properties:
            BorderRadius: =0
            Buttons: |-
              =Table({Label: "Bekreft", ButtonType:'Button.ButtonType'.Primary, HasBorder: false })
            Description: ="At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis ?"
            DialogHeight: =400
            DialogWidth: =640
            Fill: =Dialog_Bekreft_Manuell_CV.OverlayColor
            Height: =Parent.Height
            OnButtonSelect: |-
              =Patch(
                  Vaksinerings,
                  CurrentAvtale,
                  {
                      'Manuell CV Tid':Now()
                  }
              );
              UpdateContext({ showBekreftManuellCV: false, showVaksinering: true })
            OnCloseSelect: |-
              =UpdateContext({ showBekreftManuellCV: false })
            OverlayColor: =RGBA(125, 0, 0, 0.4)
            SubTitle: ="Bekreft at egenerklæring er gjennomgått og skrevet ned skriftlig for " & CurrentAvtale.Name
            Theme: =AppTheme
            Title: ="Skriftlig egenerklæring"
            Visible: =showBekreftManuellCV
            Width: =App.Width
      - Dialog_Manuell_Registrering_Bekreft:
          Control: CanvasComponent
          ComponentName: Dialog
          ComponentLibraryUniqueName: cat_powercatcomponentlibrary_0be3a
          Properties:
            BorderRadius: =0
            Buttons: |-
              =Table({Label: "Bekreft", ButtonType:'Button.ButtonType'.Primary, HasBorder: false })
            Description: ="At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis ?"
            DialogHeight: =400
            DialogWidth: =640
            Fill: =Dialog_Manuell_Registrering_Bekreft.OverlayColor
            Height: =Parent.Height
            OnButtonSelect: |-
              =UpdateContext({manuellRegistrering: true, showManuellRegistreringBekreft: false})
            OnCloseSelect: =UpdateContext({showManuellRegistreringBekreft:false})
            OverlayColor: =RGBA(125, 0, 0, 0.4)
            SubTitle: |-
              ="Du skrur nå på manuell registrering. Denne funksjonen skal kun brukes dersom egenerklæringer eller folkeregistrert har nedetid. Husk å verifisere at FNR er helt riktig, og skriv eventuelt ned egenerklæringer manuelt.

              Om folkeregisteret er oppe burde det brukes, samme gjelder egenerklæringer.

              Kun registrer manuelt det du må.

              Skru av manuell registrering når du ikke har behov for det lenger."
            Theme: =AppTheme
            Title: ="Manuell registrering"
            Visible: =showManuellRegistreringBekreft
            Width: =App.Width
