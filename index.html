<!doctype html>
<html lang="nb-NO">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VaksineApp - Vaksinasjonsadministrasjon</title>
    <meta name="description" content="Moderne vaksinasjonsadministrasjonssystem med Entra ID og DataVerse" />
    <!-- MSAL.js CDN with fallback -->
    <script>
      // Load MSAL with fallback
      function loadMSAL() {
        const script = document.createElement('script');
        script.src = 'https://alcdn.msauth.net/browser/2.38.2/js/msal-browser.min.js';
        script.onload = function() {
          console.log('MSAL loaded successfully');
          console.log('MSAL available:', typeof window.msal);
          if (window.msal) {
            console.log('MSAL PublicClientApplication available:', !!window.msal.PublicClientApplication);
          }
        };
        script.onerror = function() {
          console.error('Failed to load MSAL from primary CDN, trying fallback...');
          // Try fallback CDN
          const fallbackScript = document.createElement('script');
          fallbackScript.src = 'https://unpkg.com/@azure/msal-browser@2.38.2/dist/msal-browser.min.js';
          fallbackScript.onload = function() {
            console.log('MSAL loaded from fallback CDN');
          };
          fallbackScript.onerror = function() {
            console.error('Failed to load MSAL from both CDNs');
          };
          document.head.appendChild(fallbackScript);
        };
        document.head.appendChild(script);
      }
      
      // Load MSAL when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadMSAL);
      } else {
        loadMSAL();
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script>
      // Comprehensive polyfills for browser compatibility
      if (typeof global === 'undefined') {
        window.global = window;
      }
      if (typeof process === 'undefined') {
        window.process = { 
          env: {}, 
          platform: 'browser', 
          version: 'v16.0.0',
          browser: true,
          nextTick: (fn) => setTimeout(fn, 0)
        };
      }
      if (typeof Buffer === 'undefined') {
        window.Buffer = { isBuffer: () => false };
      }
      if (typeof require === 'undefined') {
        window.require = () => {};
      }
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
